module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=103)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return o}),r.d(t,"__assign",function(){return i}),r.d(t,"__rest",function(){return s}),r.d(t,"__decorate",function(){return a}),r.d(t,"__param",function(){return c}),r.d(t,"__metadata",function(){return u}),r.d(t,"__awaiter",function(){return p}),r.d(t,"__generator",function(){return l}),r.d(t,"__exportStar",function(){return h}),r.d(t,"__values",function(){return f}),r.d(t,"__read",function(){return d}),r.d(t,"__spread",function(){return g}),r.d(t,"__await",function(){return y}),r.d(t,"__asyncGenerator",function(){return v}),r.d(t,"__asyncDelegator",function(){return m}),r.d(t,"__asyncValues",function(){return _}),r.d(t,"__makeTemplateObject",function(){return b}),r.d(t,"__importStar",function(){return w}),r.d(t,"__importDefault",function(){return S});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}function a(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})}function l(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function h(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function f(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function d(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function v(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){i.push([e,t,r,n])>1||a(e,t)})})}function a(e,t){try{(r=o[e](t)).value instanceof y?Promise.resolve(r.value.v).then(c,u):p(i[0][2],r)}catch(e){p(i[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function p(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function m(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:y(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function _(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=f(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}}function b(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function S(e){return e&&e.__esModule?e:{default:e}}},function(e,t){e.exports=require("tsyringe")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(117);t.addBreadcrumb=n.addBreadcrumb,t.captureException=n.captureException,t.captureEvent=n.captureEvent,t.captureMessage=n.captureMessage,t.configureScope=n.configureScope,t.withScope=n.withScope;var o=r(9);t.addGlobalEventProcessor=o.addGlobalEventProcessor,t.getCurrentHub=o.getCurrentHub,t.Hub=o.Hub,t.getHubFromCarrier=o.getHubFromCarrier,t.Scope=o.Scope;var i=r(121);t.API=i.API;var s=r(122);t.BaseClient=s.BaseClient;var a=r(124);t.BaseBackend=a.BaseBackend;var c=r(35);t.Dsn=c.Dsn;var u=r(29);t.SentryError=u.SentryError;var p=r(36);t.PromiseBuffer=p.PromiseBuffer;var l=r(125);t.LogLevel=l.LogLevel;var h=r(126);t.initAndBind=h.initAndBind;var f=r(53);t.NoopTransport=f.NoopTransport;var d=r(127);t.Integrations=d},function(e,t){e.exports=require("lodash")},,function(e,t){e.exports=require("homey")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);n.__exportStar(r(23),t),n.__exportStar(r(185),t),n.__exportStar(r(186),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),o=n.getGlobalObject(),i=new(function(){function e(){this.enabled=!1}return e.prototype.disable=function(){this.enabled=!1},e.prototype.enable=function(){this.enabled=!0},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&n.consoleSandbox(function(){o.console.log("Sentry Logger [Log]: "+e.join(" "))})},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&n.consoleSandbox(function(){o.console.warn("Sentry Logger [Warn]: "+e.join(" "))})},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&n.consoleSandbox(function(){o.console.error("Sentry Logger [Error]: "+e.join(" "))})},e}());t.logger=i},function(e,t){e.exports=require("@app/helper")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(51);t.addGlobalEventProcessor=n.addGlobalEventProcessor,t.Scope=n.Scope;var o=r(119);t.getCurrentHub=o.getCurrentHub,t.getHubFromCarrier=o.getHubFromCarrier,t.getMainCarrier=o.getMainCarrier,t.Hub=o.Hub,t.setHubOnCarrier=o.setHubOnCarrier},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(13),o=r(118),i=r(28);function s(e){return JSON.stringify(e,v({normalize:!1}))}function a(e){return JSON.parse(e)}t.serialize=s,t.deserialize=a,t.clone=function(e){return a(s(e))},t.fill=function(e,t,r){if(t in e&&!e[t].__sentry__){var n=e[t],o=r(n);"function"==typeof o&&(o.prototype={},Object.defineProperties(o,{__sentry__:{enumerable:!1,value:!0},__sentry_original__:{enumerable:!1,value:n},__sentry_wrapped__:{enumerable:!1,value:o}})),e[t]=o}},t.urlEncode=function(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")};var c=3,u=102400,p=40;function l(e){return function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(e))}function h(e){var t=Object.prototype.toString.call(e);return"string"==typeof e?i.truncate(e,40):"[object Object]"===t?"[Object]":"[object Array]"===t?"[Array]":g(e)}function f(e,t){if(0===t)return h(e);if(n.isPlainObject(e)){var r={},o=e;return Object.keys(o).forEach(function(e){r[e]=f(o[e],t-1)}),r}return n.isArray(e)?e.map(function(e){return f(e,t-1)}):h(e)}function d(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),o=0;o<t.length;o++){var i=t[o];if(null!==i)for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])}return n}function g(e,t){return"domain"===t&&"object"==typeof e&&e._events?"[Domain]":"domainEmitter"===t?"[DomainEmitter]":"undefined"!=typeof global&&e===global?"[Global]":"undefined"!=typeof window&&e===window?"[Window]":"undefined"!=typeof document&&e===document?"[Document]":e instanceof Date?"[Date] "+e:e instanceof Error?function(e){var t={message:e.message,name:e.name,stack:e.stack};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}(e):"undefined"!=typeof Event&&e instanceof Event?Object.getPrototypeOf(e)?e.constructor.name:"Event":n.isNaN(e)?"[NaN]":n.isUndefined(e)?"[undefined]":"function"==typeof e?"[Function: "+(e.name||"<unknown-function-name>")+"]":e}function y(e,t){void 0===t&&(t=new o.Memo);var r=n.isArray(e)?e.slice():n.isPlainObject(e)?d({},e):e;if(!n.isPrimitive(e)){if(t.memoize(e))return"[Circular ~]";for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=y(e[i],t));t.unmemoize(e)}return r}function v(e){return void 0===e&&(e={normalize:!0}),function(t,r){return e.normalize?g(y(r),t):y(r)}}t.serializeObject=f,t.limitObjectDepthToSize=function e(t,r,n){void 0===r&&(r=c),void 0===n&&(n=u);var o=f(t,r);return l(s(o))>n?e(t,r-1):o},t.serializeKeysToEventMessage=function(e,t){if(void 0===t&&(t=p),!e.length)return"[object has no keys]";if(e[0].length>=t)return i.truncate(e[0],t);for(var r=e.length;r>0;r--){var n=e.slice(0,r).join(", ");if(!(n.length>t))return r===e.length?n:i.truncate(n,t)}return""},t.assign=d,t.decycle=y,t.safeNormalize=function(e){try{return JSON.parse(JSON.stringify(e,v({normalize:!0})))}catch(e){return"**non-serializable**"}}},function(e,t,r){"undefined"==typeof process||"renderer"===process.type?e.exports=r(168):e.exports=r(170)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);n.__exportStar(r(104),t),n.__exportStar(r(105),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isError=function(e){switch(Object.prototype.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}},t.isErrorEvent=function(e){return"[object ErrorEvent]"===Object.prototype.toString.call(e)},t.isDOMError=function(e){return"[object DOMError]"===Object.prototype.toString.call(e)},t.isDOMException=function(e){return"[object DOMException]"===Object.prototype.toString.call(e)},t.isUndefined=function(e){return void 0===e},t.isFunction=function(e){return"function"==typeof e},t.isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},t.isPrimitive=function(e){return null===e||"object"!=typeof e&&"function"!=typeof e},t.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.isPlainObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isNaN=function(e){return e!=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(5);t.flowCardActionFactory=function(e,t,r){return t.information(`Registering action ${e}`),new o.FlowCardAction(e).register().registerRunListener((o,i)=>n.__awaiter(this,void 0,void 0,function*(){try{return t.debug(`Executing ${e}`,o,i),yield r(o,i)}catch(r){return t.error(r,`Action ${e} failed`,"Args",o,"State",i),!1}}))},t.flowCardTriggerFactory=function(e,t){t.information(`Registering trigger ${e}`);const r=new o.FlowCardTrigger(e).register(),i=r.trigger.bind(r);return r.trigger=((r,o)=>n.__awaiter(this,void 0,void 0,function*(){try{return t.debug(`Trigger ${e}`,r,o),yield i(r,o)}catch(n){t.error(n,`Trigger ${e} failed`,"Tokens",r,"State",o)}})),r},t.flowCardTriggerDeviceFactory=function(e,t){t.information(`Registering trigger ${e}`);const r=new o.FlowCardTriggerDevice(e).register(),i=r.trigger.bind(r);return r.trigger=((r,o,s)=>n.__awaiter(this,void 0,void 0,function*(){try{return t.debug(`Trigger ${e}`,o,s),yield i(r,o,s)}catch(n){t.error(n,`Trigger ${e} failed`,"Device",r,"Tokens",o,"State",s)}})),r}},,function(e,t){e.exports=require("@app/model")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Fatal="fatal",e.Error="error",e.Warning="warning",e.Log="log",e.Info="info",e.Debug="debug",e.Critical="critical"}(t.Severity||(t.Severity={})),function(e){e.fromString=function(t){switch(t){case"debug":return e.Debug;case"info":return e.Info;case"warn":case"warning":return e.Warning;case"error":return e.Error;case"fatal":return e.Fatal;case"critical":return e.Critical;case"log":default:return e.Log}}}(t.Severity||(t.Severity={})),function(e){e.Unknown="unknown",e.Skipped="skipped",e.Success="success",e.RateLimit="rate_limit",e.Invalid="invalid",e.Failed="failed"}(t.Status||(t.Status={})),function(e){e.fromHttpCode=function(t){return t>=200&&t<300?e.Success:429===t?e.RateLimit:t>=400&&t<500?e.Invalid:t>=500?e.Failed:e.Unknown}}(t.Status||(t.Status={}))},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(13);function o(){return"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function i(){return o()?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}}function s(e){var t,r,o,i,s,a=[];if(!e||!e.tagName)return"";if(a.push(e.tagName.toLowerCase()),e.id&&a.push("#"+e.id),(t=e.className)&&n.isString(t))for(r=t.split(/\s+/),s=0;s<r.length;s++)a.push("."+r[s]);var c=["type","name","title","alt"];for(s=0;s<c.length;s++)o=c[s],(i=e.getAttribute(o))&&a.push("["+o+'="'+i+'"]');return a.join("")}t.dynamicRequire=function(e,t){return e.require(t)},t.isNodeEnv=o,t.getGlobalObject=i,t.uuid4=function(){var e=i(),t=e.crypto||e.msCrypto;if(void 0!==t&&t.getRandomValues){var r=new Uint16Array(8);t.getRandomValues(r),r[3]=4095&r[3]|16384,r[4]=16383&r[4]|32768;var n=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return n(r[0])+n(r[1])+n(r[2])+n(r[3])+n(r[4])+n(r[5])+n(r[6])+n(r[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},t.htmlTreeAsString=function(e){for(var t,r=e,n=[],o=0,i=0,a=" > ".length;r&&o++<5&&!("html"===(t=s(r))||o>1&&i+n.length*a+t.length>=80);)n.push(t),i+=t.length,r=r.parentNode;return n.reverse().join(" > ")},t.htmlElementAsString=s,t.parseUrl=function(e){if(!e)return{};var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var r=t[6]||"",n=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],relative:t[5]+r+n}},t.getEventDescription=function(e){if(e.message)return e.message;if(e.exception&&e.exception.values&&e.exception.values[0]){var t=e.exception.values[0];return t.type&&t.value?t.type+": "+t.value:t.type||t.value||e.event_id||"<unknown>"}return e.event_id||"<unknown>"},t.consoleSandbox=function(e){var t=i();if(!("console"in t))return e();var r=t.console,n={};["debug","info","warn","error","log"].forEach(function(e){e in t.console&&r[e].__sentry__&&(n[e]=r[e].__sentry_wrapped__,r[e]=r[e].__sentry_original__)});var o=e();return Object.keys(n).forEach(function(e){r[e]=n[e]}),o}},function(e,t){e.exports=require("util")},function(e,t,r){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks["$"+e];if(r)for(var n=0,o=(r=r.slice(0)).length;n<o;++n)r[n].apply(this,t);return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,r){var n=r(176),o=r(75),i=r(178),s=r(179);t.protocol=3;var a=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},c=s(a),u={type:"error",data:"parser error"};function p(e,r,n){if(!r)return t.encodeBase64Packet(e,n);var o=e.data,i=new Buffer(1);return i[0]=a[e.type],n(Buffer.concat([i,o]))}function l(e,t,r){for(var n=new Array(e.length),o=i(e.length,r),s=0;s<e.length;s++)t(e[s],function(e,t){n[s]=t,o(e,n)})}function h(e){for(var t="",r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);return t}function f(e){for(var t=new Buffer(e.length),r=0,n=e.length;r<n;r++)t.writeUInt8(e.charCodeAt(r),r);return t}function d(e){for(var t=new Uint8Array(e.buffer||e),r=e.byteLength||e.length,n=e.byteOffset||0,o=new Buffer(r),i=0;i<r;i++)o[i]=t[n+i];return o}function g(e,r){t.encodePacket(e,!0,!0,function(e){var t,n=""+e.length;if("string"==typeof e){(t=new Buffer(n.length+2))[0]=0;for(var o=0;o<n.length;o++)t[o+1]=parseInt(n[o],10);return t[t.length-1]=255,r(null,Buffer.concat([t,f(e)]))}for((t=new Buffer(n.length+2))[0]=1,o=0;o<n.length;o++)t[o+1]=parseInt(n[o],10);t[t.length-1]=255,r(null,Buffer.concat([t,e]))})}t.encodePacket=function(e,t,r,o){if("function"==typeof t&&(o=t,t=null),"function"==typeof r&&(o=r,r=null),Buffer.isBuffer(e.data))return p(e,t,o);if(e.data&&(e.data.buffer||e.data)instanceof ArrayBuffer)return p({type:e.type,data:d(e.data)},t,o);var i=a[e.type];return void 0!==e.data&&(i+=r?n.encode(String(e.data),{strict:!1}):String(e.data)),o(""+i)},t.encodeBase64Packet=function(e,t){var r=Buffer.isBuffer(e.data)?e.data:d(e.data),n="b"+a[e.type];return t(n+=r.toString("base64"))},t.decodePacket=function(e,r,o){if(void 0===e)return u;var i;if("string"==typeof e)return"b"===(i=e.charAt(0))?t.decodeBase64Packet(e.substr(1),r):o&&!1===(e=function(e){try{e=n.decode(e,{strict:!1})}catch(e){return!1}return e}(e))?u:Number(i)==i&&c[i]?e.length>1?{type:c[i],data:e.substring(1)}:{type:c[i]}:u;if("arraybuffer"===r){var s=new Uint8Array(e);return i=s[0],{type:c[i],data:s.buffer.slice(1)}}return e instanceof ArrayBuffer&&(e=d(e)),i=e[0],{type:c[i],data:e.slice(1)}},t.decodeBase64Packet=function(e,t){var r=c[e.charAt(0)],n=new Buffer(e.substr(1),"base64");if("arraybuffer"===t){for(var o=new Uint8Array(n.length),i=0;i<o.length;i++)o[i]=n[i];n=o.buffer}return{type:r,data:n}},t.encodePayload=function(e,r,n){if("function"==typeof r&&(n=r,r=null),r&&o(e))return t.encodePayloadAsBinary(e,n);if(!e.length)return n("0:");l(e,function(e,n){t.encodePacket(e,r,!1,function(e){n(null,function(e){return e.length+":"+e}(e))})},function(e,t){return n(t.join(""))})},t.decodePayload=function(e,r,n){if("string"!=typeof e)return t.decodePayloadAsBinary(e,r,n);if("function"==typeof r&&(n=r,r=null),""===e)return n(u,0,1);for(var o,i,s,a="",c=0,p=e.length;c<p;c++){var l=e.charAt(c);if(":"===l){if(""===a||a!=(o=Number(a)))return n(u,0,1);if(a!=(i=e.substr(c+1,o)).length)return n(u,0,1);if(i.length){if(s=t.decodePacket(i,r,!1),u.type===s.type&&u.data===s.data)return n(u,0,1);if(!1===n(s,c+o,p))return}c+=o,a=""}else a+=l}return""!==a?n(u,0,1):void 0},t.encodePayloadAsBinary=function(e,t){if(!e.length)return t(new Buffer(0));l(e,g,function(e,r){return t(Buffer.concat(r))})},t.decodePayloadAsBinary=function(e,r,n){"function"==typeof r&&(n=r,r=null);for(var o,i=e,s=[];i.length>0;){var a="",c=0===i[0];for(o=1;255!==i[o];o++){if(a.length>310)return n(u,0,1);a+=""+i[o]}i=i.slice(a.length+1);var p=parseInt(a,10),l=i.slice(1,p+1);c&&(l=h(l)),s.push(l),i=i.slice(p+1)}var f=s.length;for(o=0;o<f;o++){var d=s[o];n(t.decodePacket(d,r,!0),o,f)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(3),i=r(1),s=r(12),a=r(113),c=r(114);class u{constructor(){this.loggers=[new c.ConsoleLogger]}static get transportLog(){return u.instance.loggers[0]}static get default(){return u.instance}static init(e){i.container.resolve(s.SettingsManagerService).onChanged.subscribe((t,r)=>{r.setting!==s.Settings.ConsoleReLogEnabled&&r.setting!==s.Settings.ConsoleReLogCategory&&r.setting!==s.Settings.SentryEnabled||(u.instance.information("Reload due to settings change."),u.instance.evaluateLogger(e))}),u.instance.evaluateLogger(e)}information(...e){for(const t of this.loggers)try{t.information(...e)}catch(e){console.error("Failed to log",e)}}debug(...e){for(const t of this.loggers)try{t.debug(...e)}catch(e){console.error("Failed to log",e)}}error(e,...t){for(const r of this.loggers)try{r.error(e,...t)}catch(e){console.error("Failed to log",e)}}evaluateLogger(e){let t;const p=[],l=i.container.resolve(s.SettingsManagerService),h=l.get(s.Settings.ConsoleReLogCategory),f=l.get(s.Settings.ConsoleReLogEnabled,!1);if(!0===l.get(s.Settings.SentryEnabled,!0)){const e=r(115).SentryLogger;p.push(new e)}if(!o.isEmpty(h)&&!0===f){const e=r(165).ConsoleReLogger;p.push(new e(h))}t=null!=e?new a.AppLogger(e):new c.ConsoleLogger;const d=this.loggers.map(e=>"function"==typeof e.teardown?e.teardown():Promise.resolve(!0)).filter(Boolean);this.loggers=[t,...p],d.length>0&&setImmediate(()=>n.__awaiter(this,void 0,void 0,function*(){return yield Promise.all(d).catch(e=>{u.instance.error(e,"Could not teardown loggers")})}))}}u.instance=new u,t.LogService=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(0).__exportStar(r(193),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Enforce="enforce_policy",e.CheckTemperature="check_policy",e.Throttled_Enforce="throttled_enforce_policy",e.Throttled_CheckTemperature="throttled_check_policy"}(t.PolicyType||(t.PolicyType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(0).__exportStar(r(196),t)},function(e,t,r){"use strict";
/*!
 * Strongly Typed Events for TypeScript - Core
 * https://github.com/KeesCBakker/StronlyTypedEvents/
 * http://keestalkstech.com
 *
 * Copyright Kees C. Bakker / KeesTalksTech
 * Released under the MIT license
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(106);t.DispatcherBase=n.DispatcherBase,t.DispatcherWrapper=n.DispatcherWrapper,t.EventListBase=n.EventListBase;var o=r(50);t.Subscription=o.Subscription},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(13);t.truncate=function(e,t){return void 0===t&&(t=0),0!==t&&n.isString(e)?e.length<=t?e:e.substr(0,t)+"...":e},t.snipLine=function(e,t){var r=e,n=r.length;if(n<=150)return r;t>n&&(t=n);var o=Math.max(t-60,0);o<5&&(o=0);var i=Math.min(o+140,n);return i>n-5&&(i=n),i===n&&(o=Math.max(i-140,0)),r=r.slice(o,i),o>0&&(r="'{snip} "+r),i<n&&(r+=" {snip}"),r},t.safeJoin=function(e,t){if(!Array.isArray(e))return"";for(var r=[],n=0;n<e.length;n++){var o=e[n];try{r.push(String(o))}catch(e){r.push("[value cannot be serialized]")}}return r.join(t)},t.includes=function(e,t){return!(t.length>e.length)&&-1!==e.indexOf(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=function(e){function t(t){var r=this.constructor,n=e.call(this,t)||this;return n.message=t,n.name=r.prototype.constructor.name,Object.setPrototypeOf(n,r.prototype),n}return n.__extends(t,e),t}(Error);t.SentryError=o},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("url")},function(e,t){t.encode=function(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t},t.decode=function(e){for(var t={},r=e.split("&"),n=0,o=r.length;n<o;n++){var i=r[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},function(e,t){e.exports=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(108);t.EventDispatcher=n.EventDispatcher,t.EventHandlingBase=n.EventHandlingBase,t.EventList=n.EventList},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(13),i=r(10),s=r(29),a=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w\.-]+)(?::(\d+))?\/(.+)/,c=function(){function e(e){"string"==typeof e?this.fromString(e):this.fromComponents(e),this.validate()}return e.prototype.toString=function(e){void 0===e&&(e=!1);var t=this,r=t.host,n=t.path,o=t.pass,i=t.port,s=t.projectId;return t.protocol+"://"+t.user+(e&&o?":"+o:"")+"@"+r+(i?":"+i:"")+"/"+(n?n+"/":n)+s},e.prototype.fromString=function(e){var t=a.exec(e);if(!t)throw new s.SentryError("Invalid Dsn");var r=n.__read(t.slice(1),6),o=r[0],c=r[1],u=r[2],p=void 0===u?"":u,l=r[3],h=r[4],f=void 0===h?"":h,d="",g=r[5],y=g.split("/");y.length>1&&(d=y.slice(0,-1).join("/"),g=y.pop()),i.assign(this,{host:l,pass:p,path:d,projectId:g,port:f,protocol:o,user:c})},e.prototype.fromComponents=function(e){this.protocol=e.protocol,this.user=e.user,this.pass=e.pass||"",this.host=e.host,this.port=e.port||"",this.path=e.path||"",this.projectId=e.projectId},e.prototype.validate=function(){var e,t;try{for(var r=n.__values(["protocol","user","host","projectId"]),i=r.next();!i.done;i=r.next()){var a=i.value;if(!this[a])throw new s.SentryError("Invalid Dsn: Missing "+a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}if("http"!==this.protocol&&"https"!==this.protocol)throw new s.SentryError('Invalid Dsn: Unsupported protocol "'+this.protocol+'"');if(this.port&&o.isNaN(parseInt(this.port,10)))throw new s.SentryError('Invalid Dsn: Invalid port number "'+this.port+'"')},e}();t.Dsn=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(29),i=function(){function e(e){this.limit=e,this.buffer=[]}return e.prototype.isReady=function(){return void 0===this.limit||this.length()<this.limit},e.prototype.add=function(e){return n.__awaiter(this,void 0,void 0,function(){var t=this;return n.__generator(this,function(r){return this.isReady()?(-1===this.buffer.indexOf(e)&&this.buffer.push(e),e.then(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.remove(e)]})})}).catch(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.remove(e).catch(function(){})]})})}),[2,e]):[2,Promise.reject(new o.SentryError("Not adding Promise due to buffer limit reached."))]})})},e.prototype.remove=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.buffer.splice(this.buffer.indexOf(e),1)[0]]})})},e.prototype.length=function(){return this.buffer.length},e.prototype.drain=function(e){return n.__awaiter(this,void 0,void 0,function(){var t=this;return n.__generator(this,function(r){return[2,new Promise(function(r){var n=setTimeout(function(){e&&e>0&&r(!1)},e);Promise.all(t.buffer).then(function(){clearTimeout(n),r(!0)}).catch(function(){r(!0)})})]})})},e}();t.PromiseBuffer=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(136),i=r(54),s=r(28),a=r(137),c=r(138),u=7,p=new a.LRUMap(100);function l(e){try{return e.getFunctionName()||e.getTypeName()+"."+(e.getMethodName()||"<anonymous>")}catch(e){return"<anonymous>"}}t.resetFileContentCache=function(){p.clear()};var h=(r.c[r.s]&&r.c[r.s].filename&&i.dirname(r.c[r.s].filename)||global.process.cwd())+"/";function f(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s,a;return n.__generator(this,function(n){switch(n.label){case 0:if(0===e.length)return[2,{}];t={},r=0,n.label=1;case 1:if(!(r<e.length))return[3,7];if(i=e[r],void 0!==(s=p.get(i)))return null!==s&&(t[i]=s),[3,6];a=null,n.label=2;case 2:return n.trys.push([2,4,,5]),[4,o.readFileAsync(i)];case 3:return a=n.sent(),t[i]=a,[3,5];case 4:return n.sent(),[3,5];case 5:p.set(i,a),n.label=6;case 6:return r++,[3,1];case 7:return[2,t]}})})}function d(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(r){return(t=c.parse(e))?[2,t]:[2,[]]})})}function g(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,o,s;return n.__generator(this,function(n){switch(n.label){case 0:if(r=[],o=t&&void 0!==t.frameContextLines?t.frameContextLines:u,s=e.map(function(e){var t={colno:e.getColumnNumber(),filename:e.getFileName()||"",function:l(e),lineno:e.getLineNumber()},n=e.isNative()||t.filename&&!t.filename.startsWith("/")&&!t.filename.startsWith(".")&&1!==t.filename.indexOf(":\\");return t.in_app=!n&&void 0!==t.filename&&!t.filename.includes("node_modules/"),t.filename&&(t.module=function(e,t){t||(t=h);var r=i.basename(e,".js"),n=(e=i.dirname(e)).lastIndexOf("/node_modules/");if(n>-1)return e.substr(n+14).replace(/\//g,".")+":"+r;if(0===(n=(e+"/").lastIndexOf(t,0))){var o=e.substr(t.length).replace(/\//g,".");return o&&(o+=":"),o+=r}return r}(t.filename),!n&&o>0&&r.push(t.filename)),t}),o<=0)return[2,s];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,y(r,s,o)];case 2:return[2,n.sent()];case 3:return n.sent(),[2,s];case 4:return[2]}})})}function y(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,f(e)];case 1:return o=n.sent(),[2,t.map(function(e){if(e.filename&&o[e.filename])try{var t=o[e.filename].split("\n");e.pre_context=t.slice(Math.max(0,(e.lineno||0)-(r+1)),(e.lineno||0)-1).map(function(e){return s.snipLine(e,0)}),e.context_line=s.snipLine(t[(e.lineno||0)-1],e.colno||0),e.post_context=t.slice(e.lineno||0,(e.lineno||0)+r).map(function(e){return s.snipLine(e,0)})}catch(e){}return e})]}})})}function v(e,t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return r=e.name||e.constructor.name,[4,d(e)];case 1:return[4,g(n.sent(),t)];case 2:return[2,{stacktrace:{frames:m(n.sent())},type:r,value:e.message}]}})})}function m(e){if(!e||!e.length)return[];var t=e,r=t[0].function||"";return(r.includes("captureMessage")||r.includes("captureException"))&&(t=t.slice(1)),t.reverse()}t.extractStackFromError=d,t.parseStack=g,t.getExceptionFromError=v,t.parseError=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return r=e.name||e.constructor.name,[4,v(e,t)];case 1:return[2,{exception:{values:[n.sent()]},message:r+": "+(e.message||"<no message>")}]}})})},t.prepareFramesForEvent=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=r(17),s=r(30),a=r(39),c=function(){function e(e){this.options=e,this.buffer=new o.PromiseBuffer(30),this.api=new o.API(e.dsn)}return e.prototype.getRequestOptions=function(){var e=n.__assign({},this.api.getRequestHeaders(a.SDK_NAME,a.SDK_VERSION),this.options.headers),t=this.api.getDsn(),r={agent:this.client,headers:e,hostname:t.host,method:"POST",path:this.api.getStoreEndpointPath(),port:t.port,protocol:t.protocol+":"};return this.options.caCerts&&(r.ca=s.readFileSync(this.options.caCerts)),r},e.prototype.sendWithModule=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r=this;return n.__generator(this,function(n){return[2,this.buffer.add(new Promise(function(n,s){var a=e.request(r.getRequestOptions(),function(e){if(e.setEncoding("utf8"),e.statusCode&&e.statusCode>=200&&e.statusCode<300)n({status:i.Status.fromHttpCode(e.statusCode)});else if(e.headers&&e.headers["x-sentry-error"]){var t=e.headers["x-sentry-error"];s(new o.SentryError("HTTP Error ("+e.statusCode+"): "+t))}else s(new o.SentryError("HTTP Error ("+e.statusCode+")"));e.on("data",function(){}),e.on("end",function(){})});a.on("error",s),a.end(t)}))]})})},e.prototype.sendEvent=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){throw new o.SentryError("Transport Class has to implement `sendEvent` method.")})})},e.prototype.close=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.buffer.drain(e)]})})},e}();t.BaseTransport=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SDK_NAME="sentry.javascript.node",t.SDK_VERSION="4.6.1"},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("https")},function(e,t,r){var n=r(11)("socket.io-parser"),o=r(21),i=r(171),s=r(70),a=r(71);function c(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=c,t.Decoder=l;var u=t.ERROR+'"encode error"';function p(e){var r=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(r+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(r+=e.nsp+","),null!=e.id&&(r+=e.id),null!=e.data){var o=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===o)return u;r+=o}return n("encoded %j as %s",e,r),r}function l(){this.reconstructor=null}function h(e){this.reconPack=e,this.buffers=[]}function f(e){return{type:t.ERROR,data:"parser error: "+e}}c.prototype.encode=function(e,r){(n("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){i.removeBlobs(e,function(e){var r=i.deconstructPacket(e),n=p(r.packet),o=r.buffers;o.unshift(n),t(o)})}(e,r):r([p(e)])},o(l.prototype),l.prototype.add=function(e){var r;if("string"==typeof e)r=function(e){var r=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return f("unknown packet type "+o.type);if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var i="";"-"!==e.charAt(++r)&&(i+=e.charAt(r),r!=e.length););if(i!=Number(i)||"-"!==e.charAt(r))throw new Error("Illegal attachments");o.attachments=Number(i)}if("/"===e.charAt(r+1))for(o.nsp="";++r;){var a=e.charAt(r);if(","===a)break;if(o.nsp+=a,r===e.length)break}else o.nsp="/";var c=e.charAt(r+1);if(""!==c&&Number(c)==c){for(o.id="";++r;){var a=e.charAt(r);if(null==a||Number(a)!=a){--r;break}if(o.id+=e.charAt(r),r===e.length)break}o.id=Number(o.id)}if(e.charAt(++r)){var u=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(r)),p=!1!==u&&(o.type===t.ERROR||s(u));if(!p)return f("invalid payload");o.data=u}return n("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type?(this.reconstructor=new h(r),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",r)):this.emit("decoded",r);else{if(!a(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(r=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",r))}},l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},h.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=i.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},h.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,r){
/**
 * Wrapper for built-in http.js to emulate the browser XMLHttpRequest object.
 *
 * This can be used with JS designed for browsers to improve reuse of code and
 * allow the use of existing libraries.
 *
 * Usage: include("XMLHttpRequest.js") and use XMLHttpRequest per W3C specs.
 *
 * @author Dan DeFelippi <dan@driverdan.com>
 * @contributor David Ellis <d.f.ellis@ieee.org>
 * @license MIT
 */
var n=r(30),o=r(31),i=r(174).spawn;function s(e){"use strict";e=e||{};var t,s,a=this,c=r(40),u=r(41),p={},l=!1,h={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},f=Object.assign({},h),d=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],g=["TRACE","TRACK","CONNECT"],y=!1,v=!1,m={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null;this.open=function(e,t,r,n,o){if(this.abort(),v=!1,!function(e){return e&&-1===g.indexOf(e)}(e))throw"SecurityError: Request method not allowed";p={method:e,url:t.toString(),async:"boolean"!=typeof r||r,user:n||null,password:o||null},_(this.OPENED)},this.setDisableHeaderCheck=function(e){l=e},this.setRequestHeader=function(e,t){if(this.readyState!=this.OPENED)throw"INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN";if(!function(e){return l||e&&-1===d.indexOf(e.toLowerCase())}(e))return console.warn('Refused to set unsafe header "'+e+'"'),!1;if(y)throw"INVALID_STATE_ERR: send flag is true";return f[e]=t,!0},this.getResponseHeader=function(e){return"string"==typeof e&&this.readyState>this.OPENED&&s.headers[e.toLowerCase()]&&!v?s.headers[e.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||v)return"";var e="";for(var t in s.headers)"set-cookie"!==t&&"set-cookie2"!==t&&(e+=t+": "+s.headers[t]+"\r\n");return e.substr(0,e.length-2)},this.getRequestHeader=function(e){return"string"==typeof e&&f[e]?f[e]:""},this.send=function(r){if(this.readyState!=this.OPENED)throw"INVALID_STATE_ERR: connection must be opened before send() is called";if(y)throw"INVALID_STATE_ERR: send has already been called";var l,h=!1,d=!1,g=o.parse(p.url);switch(g.protocol){case"https:":h=!0;case"http:":l=g.hostname;break;case"file:":d=!0;break;case void 0:case"":l="localhost";break;default:throw"Protocol not supported."}if(d){if("GET"!==p.method)throw"XMLHttpRequest: Only GET method is supported";if(p.async)n.readFile(g.pathname,"utf8",function(e,t){e?a.handleError(e):(a.status=200,a.responseText=t,_(a.DONE))});else try{this.responseText=n.readFileSync(g.pathname,"utf8"),this.status=200,_(a.DONE)}catch(e){this.handleError(e)}}else{var m=g.port||(h?443:80),b=g.pathname+(g.search?g.search:"");if(f.Host=l,h&&443===m||80===m||(f.Host+=":"+g.port),p.user){void 0===p.password&&(p.password="");var w=new Buffer(p.user+":"+p.password);f.Authorization="Basic "+w.toString("base64")}"GET"===p.method||"HEAD"===p.method?r=null:r?(f["Content-Length"]=Buffer.isBuffer(r)?r.length:Buffer.byteLength(r),f["Content-Type"]||(f["Content-Type"]="text/plain;charset=UTF-8")):"POST"===p.method&&(f["Content-Length"]=0);var S=e.agent||!1,E={host:l,port:m,path:b,method:p.method,headers:f,agent:S};if(h&&(E.pfx=e.pfx,E.key=e.key,E.passphrase=e.passphrase,E.cert=e.cert,E.ca=e.ca,E.ciphers=e.ciphers,E.rejectUnauthorized=e.rejectUnauthorized),v=!1,p.async){var C=h?u.request:c.request;y=!0,a.dispatchEvent("readystatechange");var x=function(r){if(302===(s=r).statusCode||303===s.statusCode||307===s.statusCode){p.url=s.headers.location;var n=o.parse(p.url);l=n.hostname;var i={hostname:n.hostname,port:n.port,path:n.path,method:303===s.statusCode?"GET":p.method,headers:f};return h&&(i.pfx=e.pfx,i.key=e.key,i.passphrase=e.passphrase,i.cert=e.cert,i.ca=e.ca,i.ciphers=e.ciphers,i.rejectUnauthorized=e.rejectUnauthorized),void(t=C(i,x).on("error",O)).end()}s&&s.setEncoding&&s.setEncoding("utf8"),_(a.HEADERS_RECEIVED),a.status=s.statusCode,s.on("data",function(e){e&&(a.responseText+=e),y&&_(a.LOADING)}),s.on("end",function(){y&&(y=!1,_(a.DONE))}),s.on("error",function(e){a.handleError(e)})},O=function(e){a.handleError(e)};t=C(E,x).on("error",O),r&&t.write(r),t.end(),a.dispatchEvent("loadstart")}else{var k=".node-xmlhttprequest-content-"+process.pid,T=".node-xmlhttprequest-sync-"+process.pid;n.writeFileSync(T,"","utf8");for(var P="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(h?"s":"")+".request;var options = "+JSON.stringify(E)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+k+"', 'NODE-XMLHTTPREQUEST-STATUS:' + response.statusCode + ',' + responseText, 'utf8');fs.unlinkSync('"+T+"');});response.on('error', function(error) {fs.writeFileSync('"+k+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+T+"');});}).on('error', function(error) {fs.writeFileSync('"+k+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+T+"');});"+(r?"req.write('"+r.replace(/'/g,"\\'")+"');":"")+"req.end();",M=i(process.argv[0],["-e",P]);n.existsSync(T););if(a.responseText=n.readFileSync(k,"utf8"),M.stdin.end(),n.unlinkSync(k),a.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var A=a.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,"");a.handleError(A)}else a.status=a.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1"),a.responseText=a.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"),_(a.DONE)}}},this.handleError=function(e){this.status=503,this.statusText=e,this.responseText=e.stack,v=!0,_(this.DONE)},this.abort=function(){t&&(t.abort(),t=null),f=Object.assign({},h),this.responseText="",this.responseXML="",v=!0,this.readyState===this.UNSENT||this.readyState===this.OPENED&&!y||this.readyState===this.DONE||(y=!1,_(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(e,t){e in m||(m[e]=[]),m[e].push(t)},this.removeEventListener=function(e,t){e in m&&(m[e]=m[e].filter(function(e){return e!==t}))},this.dispatchEvent=function(e){if("function"==typeof a["on"+e]&&a["on"+e](),e in m)for(var t=0,r=m[e].length;t<r;t++)m[e][t].call(a)};var _=function(e){a.readyState!==e&&(a.readyState=e,(p.async||a.readyState<a.OPENED||a.readyState===a.DONE)&&a.dispatchEvent("readystatechange"),a.readyState!==a.DONE||v||(a.dispatchEvent("load"),a.dispatchEvent("loadend")))}}e.exports=s,s.XMLHttpRequest=s},function(e,t,r){var n=r(22),o=r(21);function i(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=i,o(i.prototype),i.prototype.onError=function(e,t){var r=new Error(e);return r.type="TransportError",r.description=t,this.emit("error",r),this},i.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},i.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},i.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},i.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},i.prototype.onData=function(e){var t=n.decodePacket(e,this.socket.binaryType);this.onPacket(t)},i.prototype.onPacket=function(e){this.emit("packet",e)},i.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(0).__exportStar(r(190),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(0).__exportStar(r(192),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);r(84),r(85),r(194),n.__exportStar(r(195),t);var o=r(25);t.PolicyTypes=o.PolicyType},,function(e,t,r){"use strict";
/*!
 * Strongly Typed Events for TypeScript
 * https://github.com/KeesCBakker/StronlyTypedEvents/
 * http://keestalkstech.com
 *
 * Copyright Kees C. Bakker / KeesTalksTech
 * Released under the MIT license
 */Object.defineProperty(t,"__esModule",{value:!0});var n=r(27);t.DispatcherBase=n.DispatcherBase,t.DispatcherWrapper=n.DispatcherWrapper,t.EventListBase=n.EventListBase,t.Subscription=n.Subscription;var o=r(34);t.EventDispatcher=o.EventDispatcher,t.EventHandlingBase=o.EventHandlingBase,t.EventList=o.EventList;var i=r(109);t.SimpleEventDispatcher=i.SimpleEventDispatcher,t.SimpleEventHandlingBase=i.SimpleEventHandlingBase,t.SimpleEventList=i.SimpleEventList;var s=r(111);t.SignalDispatcher=s.SignalDispatcher,t.SignalHandlingBase=s.SignalHandlingBase,t.SignalList=s.SignalList},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.handler=e,this.isOnce=t,this.isExecuted=!1}return e.prototype.execute=function(e,t,r){if(!this.isOnce||!this.isExecuted){this.isExecuted=!0;var n=this.handler;e?setTimeout(function(){n.apply(t,r)},1):n.apply(t,r)}},e}();t.Subscription=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(19),i=r(10),s=function(){function e(){this.notifyingListeners=!1,this.scopeListeners=[],this.eventProcessors=[],this.breadcrumbs=[],this.user={},this.tags={},this.extra={}}return e.prototype.addScopeListener=function(e){this.scopeListeners.push(e)},e.prototype.addEventProcessor=function(e){return this.eventProcessors.push(e),this},e.prototype.notifyScopeListeners=function(){var e=this;this.notifyingListeners||(this.notifyingListeners=!0,setTimeout(function(){e.scopeListeners.forEach(function(t){t(e)}),e.notifyingListeners=!1}))},e.prototype.notifyEventProcessors=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,o,i,s,c,u,p;return n.__generator(this,function(l){switch(l.label){case 0:i=e,l.label=1;case 1:l.trys.push([1,8,9,10]),s=n.__values(n.__spread(a(),this.eventProcessors)),c=s.next(),l.label=2;case 2:if(c.done)return[3,7];u=c.value,l.label=3;case 3:return l.trys.push([3,5,,6]),[4,u(n.__assign({},i),t)];case 4:return null===(i=l.sent())?[2,null]:[3,6];case 5:return l.sent(),[3,6];case 6:return c=s.next(),[3,2];case 7:return[3,10];case 8:return p=l.sent(),r={error:p},[3,10];case 9:try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}return[7];case 10:return[2,i]}})})},e.prototype.setUser=function(e){return this.user=i.safeNormalize(e),this.notifyScopeListeners(),this},e.prototype.setTag=function(e,t){var r;return this.tags=n.__assign({},this.tags,((r={})[e]=i.safeNormalize(t),r)),this.notifyScopeListeners(),this},e.prototype.setExtra=function(e,t){var r;return this.extra=n.__assign({},this.extra,((r={})[e]=i.safeNormalize(t),r)),this.notifyScopeListeners(),this},e.prototype.setFingerprint=function(e){return this.fingerprint=i.safeNormalize(e),this.notifyScopeListeners(),this},e.prototype.setLevel=function(e){return this.level=i.safeNormalize(e),this.notifyScopeListeners(),this},e.clone=function(t){var r=new e;return i.assign(r,t,{scopeListeners:[]}),t&&(r.extra=i.assign(t.extra),r.tags=i.assign(t.tags),r.breadcrumbs=n.__spread(t.breadcrumbs),r.eventProcessors=n.__spread(t.eventProcessors)),r},e.prototype.clear=function(){this.breadcrumbs=[],this.tags={},this.extra={},this.user={},this.level=void 0,this.fingerprint=void 0,this.notifyScopeListeners()},e.prototype.addBreadcrumb=function(e,t){this.breadcrumbs=void 0!==t&&t>=0?n.__spread(this.breadcrumbs,[i.safeNormalize(e)]).slice(-t):n.__spread(this.breadcrumbs,[i.safeNormalize(e)]),this.notifyScopeListeners()},e.prototype.applyFingerprint=function(e){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],this.fingerprint?e.fingerprint=e.fingerprint.concat(this.fingerprint):e.message&&(e.fingerprint=e.fingerprint.concat(e.message)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint},e.prototype.applyToEvent=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(o){return this.extra&&Object.keys(this.extra).length&&(e.extra=n.__assign({},this.extra,e.extra)),this.tags&&Object.keys(this.tags).length&&(e.tags=n.__assign({},this.tags,e.tags)),this.user&&Object.keys(this.user).length&&(e.user=n.__assign({},this.user,e.user)),this.level&&(e.level=this.level),this.applyFingerprint(e),(!e.breadcrumbs||0===e.breadcrumbs.length)&&this.breadcrumbs.length>0&&(e.breadcrumbs=void 0!==r&&r>=0?this.breadcrumbs.slice(-r):this.breadcrumbs),[2,this.notifyEventProcessors(e,t)]})})},e}();function a(){var e=o.getGlobalObject();return e.__SENTRY__=e.__SENTRY__||{},e.__SENTRY__.globalEventProcessors=e.__SENTRY__.globalEventProcessors||[],e.__SENTRY__.globalEventProcessors}t.Scope=s,t.addGlobalEventProcessor=function(e){a().push(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.forget=function(e){e.catch(function(e){console.error(e)})},t.filterAsync=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(t,r))];case 1:return o=n.sent(),[2,e.filter(function(e,t){return o[t]})]}})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(17),i=function(){function e(){}return e.prototype.sendEvent=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,Promise.resolve({reason:"NoopTransport: Event has been skipped because no Dsn is configured.",status:o.Status.Skipped})]})})},e.prototype.close=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,Promise.resolve(!0)]})})},e}();t.NoopTransport=i},function(e,t,r){"use strict";function n(e,t){for(var r=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}Object.defineProperty(t,"__esModule",{value:!0});var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function i(e){var t=o.exec(e);return t?t.slice(1):[]}function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r="",o=!1,i=e.length-1;i>=-1&&!o;i--){var s=i>=0?e[i]:"/";s&&(r=s+"/"+r,o="/"===s.charAt(0))}return(o?"/":"")+(r=n(r.split("/").filter(function(e){return!!e}),!o).join("/"))||"."}function a(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}function c(e){var t=u(e),r="/"===e.substr(-1),o=n(e.split("/").filter(function(e){return!!e}),!t).join("/");return o||t||(o="."),o&&r&&(o+="/"),(t?"/":"")+o}function u(e){return"/"===e.charAt(0)}t.resolve=s,t.relative=function(e,t){e=s(e).substr(1),t=s(t).substr(1);for(var r=a(e.split("/")),n=a(t.split("/")),o=Math.min(r.length,n.length),i=o,c=0;c<o;c++)if(r[c]!==n[c]){i=c;break}var u=[];for(c=i;c<r.length;c++)u.push("..");return(u=u.concat(n.slice(i))).join("/")},t.normalize=c,t.isAbsolute=u,t.join=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c(e.join("/"))},t.dirname=function(e){var t=i(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},t.basename=function(e,t){var r=i(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=r(17),s=r(13),a=r(10),c=r(135),u=r(37),p=r(57),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.setupTransport=function(){var t,r;if(!this.options.dsn)return e.prototype.setupTransport.call(this);var i=new o.Dsn(this.options.dsn),s=this.options.transportOptions||{dsn:i};try{for(var a=n.__values(["httpProxy","httpsProxy","caCerts"]),c=a.next();!c.done;c=a.next()){var u=c.value;(this.options[u]||s[u])&&(s[u]=s[u]||this.options[u])}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return this.options.transport?new this.options.transport(s):"http"===i.protocol?new p.HTTPTransport(s):new p.HTTPSTransport(s)},t.prototype.eventFromException=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,i,p,l;return n.__generator(this,function(h){switch(h.label){case 0:return r=e,s.isError(e)||(s.isPlainObject(e)?(i=Object.keys(e).sort(),p="Non-Error exception captured with keys: "+a.serializeKeysToEventMessage(i),o.getCurrentHub().configureScope(function(t){t.setExtra("__serialized__",a.limitObjectDepthToSize(e)),t.setFingerprint([c.createHash("md5").update(i.join("")).digest("hex")])}),(r=t&&t.syntheticException||new Error(p)).message=p):r=t&&t.syntheticException||new Error(e)),[4,u.parseError(r,this.options)];case 1:return l=h.sent(),[2,n.__assign({},l,{event_id:t&&t.event_id})]}})})},t.prototype.eventFromMessage=function(e,t,r){return void 0===t&&(t=i.Severity.Info),n.__awaiter(this,void 0,void 0,function(){var o,i,s,a;return n.__generator(this,function(n){switch(n.label){case 0:return o={event_id:r&&r.event_id,level:t,message:e},this.options.attachStacktrace&&r&&r.syntheticException?r.syntheticException?[4,u.extractStackFromError(r.syntheticException)]:[3,2]:[3,5];case 1:return s=n.sent(),[3,3];case 2:s=[],n.label=3;case 3:return i=s,[4,u.parseStack(i,this.options)];case 4:a=n.sent(),o.stacktrace={frames:u.prepareFramesForEvent(a)},n.label=5;case 5:return[2,o]}})})},t}(o.BaseBackend);t.NodeBackend=l},function(e,t){e.exports=require("path")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(38);t.BaseTransport=n.BaseTransport;var o=r(139);t.HTTPTransport=o.HTTPTransport;var i=r(153);t.HTTPSTransport=i.HTTPSTransport},function(e,t,r){var n=r(140),o=r(141),i=r(31),s=r(142),a=r(20).inherits,c=r(148)("https-proxy-agent");function u(e){if(!(this instanceof u))return new u(e);if("string"==typeof e&&(e=i.parse(e)),!e)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");c("creating new HttpsProxyAgent instance: %o",e),s.call(this,e);var t=Object.assign({},e);this.secureProxy=!!t.protocol&&/^https:?$/i.test(t.protocol),t.host=t.hostname||t.host,t.port=+t.port||(this.secureProxy?443:80),!this.secureProxy||"ALPNProtocols"in t||(t.ALPNProtocols=["http 1.1"]),t.host&&t.path&&(delete t.path,delete t.pathname),this.proxy=t,this.defaultPort=443}e.exports=u,a(u,s),u.prototype.callback=function(e,t,r){var i,s=this.proxy;i=this.secureProxy?o.connect(s):n.connect(s);var a=[],u=0;function p(){var e=i.read();e?g(e):i.once("readable",p)}function l(){i.removeListener("data",g),i.removeListener("end",f),i.removeListener("error",d),i.removeListener("close",h),i.removeListener("readable",p)}function h(e){c("onclose had error %o",e)}function f(){c("onend")}function d(e){l(),r(e)}function g(n){a.push(n),u+=n.length;var s=Buffer.concat(a,u),h=s.toString("ascii");if(!~h.indexOf("\r\n\r\n"))return c("have not received end of HTTP headers yet..."),void(i.read?p():i.once("data",g));var f=h.substring(0,h.indexOf("\r\n")),d=+f.split(" ")[1];if(c("got proxy server response: %o",f),200==d){var v=i;a=s=null,t.secureEndpoint&&(c("upgrading proxy-connected socket to TLS connection: %o",t.host),t.socket=i,t.servername=t.servername||t.host,t.host=null,t.hostname=null,t.port=null,v=o.connect(t)),l(),r(null,v)}else l(),a=s,e.once("socket",y),r(null,i)}function y(e){if("function"==typeof e.ondata)e.ondata(a,0,a.length);else{if(!(e.listeners("data").length>0))throw new Error("should not happen...");e.emit("data",a)}a=null}i.on("error",d),i.on("close",h),i.on("end",f),i.read?p():i.once("data",g);var v="CONNECT "+(t.host+":"+t.port)+" HTTP/1.1\r\n",m=Object.assign({},s.headers);s.auth&&(m["Proxy-Authorization"]="Basic "+Buffer.from(s.auth).toString("base64"));var _,b,w=t.host;_=t.port,b=t.secureEndpoint,Boolean(!b&&80===_||b&&443===_)||(w+=":"+t.port),m.Host=w,m.Connection="close",Object.keys(m).forEach(function(e){v+=e+": "+m[e]+"\r\n"}),i.write(v+"\r\n")}},function(e,t,r){"use strict";e.exports=function(e){function t(e){for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return n.colors[Math.abs(t)%n.colors.length]}function n(e){var r;function s(){if(s.enabled){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];var i=s,a=Number(new Date),c=a-(r||a);i.diff=c,i.prev=r,i.curr=a,r=a,t[0]=n.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var u=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(e,r){if("%%"===e)return e;u++;var o=n.formatters[r];if("function"==typeof o){var s=t[u];e=o.call(i,s),t.splice(u,1),u--}return e}),n.formatArgs.call(i,t),(i.log||n.log).apply(i,t)}}return s.namespace=e,s.enabled=n.enabled(e),s.useColors=n.useColors(),s.color=t(e),s.destroy=o,s.extend=i,"function"==typeof n.init&&n.init(s),n.instances.push(s),s}function o(){var e=n.instances.indexOf(this);return-1!==e&&(n.instances.splice(e,1),!0)}function i(e,t){return n(this.namespace+(void 0===t?":":t)+e)}return n.debug=n,n.default=n,n.coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){n.enable("")},n.enable=function(e){var t;n.save(e),n.names=[],n.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(t=0;t<o;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){var i=n.instances[t];i.enabled=n.enabled(i.namespace)}},n.enabled=function(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=r(150),Object.keys(e).forEach(function(t){n[t]=e[t]}),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=t,n.enable(n.load()),n}},function(e,t){e.exports=require("tty")},function(e,t,r){"use strict";const n=r(62),o=r(152),{env:i}=process;let s;function a(e){return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(function(e){if(0===s)return 0;if(o("color=16m")||o("color=full")||o("color=truecolor"))return 3;if(o("color=256"))return 2;if(e&&!e.isTTY&&void 0===s)return 0;const t=s||0;if("dumb"===i.TERM)return t;if("win32"===process.platform){const e=n.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in i)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(e=>e in i)||"codeship"===i.CI_NAME?1:t;if("TEAMCITY_VERSION"in i)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(i.TEAMCITY_VERSION)?1:0;if("truecolor"===i.COLORTERM)return 3;if("TERM_PROGRAM"in i){const e=parseInt((i.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(i.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(i.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(i.TERM)?1:"COLORTERM"in i?1:t}(e))}o("no-color")||o("no-colors")||o("color=false")||o("color=never")?s=0:(o("color")||o("colors")||o("color=true")||o("color=always"))&&(s=1),"FORCE_COLOR"in i&&(s=!0===i.FORCE_COLOR||"true"===i.FORCE_COLOR?1:!1===i.FORCE_COLOR||"false"===i.FORCE_COLOR?0:0===i.FORCE_COLOR.length?1:Math.min(parseInt(i.FORCE_COLOR,10),3)),e.exports={supportsColor:a,stdout:a(process.stdout),stderr:a(process.stderr)}},function(e,t){e.exports=require("os")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=r(55),s=r(39),a=function(e){function t(t){return e.call(this,i.NodeBackend,t)||this}return n.__extends(t,e),t.prototype.prepareEvent=function(t,r,o){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(i){return t.platform=t.platform||"node",t.sdk=n.__assign({},t.sdk,{name:s.SDK_NAME,packages:n.__spread(t.sdk&&t.sdk.packages||[],[{name:"npm:@sentry/node",version:s.SDK_VERSION}]),version:s.SDK_VERSION}),this.getOptions().serverName&&(t.server_name=this.getOptions().serverName),[2,e.prototype.prepareEvent.call(this,t,r,o)]})})},t}(o.BaseClient);t.NodeClient=a},function(e,t){e.exports=require("domain")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(155);t.Console=n.Console;var o=r(157);t.Http=o.Http;var i=r(158);t.OnUncaughtException=i.OnUncaughtException;var s=r(160);t.OnUnhandledRejection=s.OnUnhandledRejection;var a=r(161);t.LinkedErrors=a.LinkedErrors;var c=r(162);t.Modules=c.Modules;var u=r(164);t.Transaction=u.Transaction},function(e,t){e.exports=require("module")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=r(52),s=r(7),a=r(10),c=r(159),u=r(64),p=r(62),l=r(31),h=2e3;var f=["id","username","email"];function d(e,t,r){if((r=n.__assign({request:!0,serverName:!0,transaction:!0,user:!0,version:!0},r)).version&&(e.extra=n.__assign({},e.extra,{node:global.process.version})),r.request&&(e.request=n.__assign({},e.request,function(e){var t=e.headers||e.header||{},r=e.method,n=e.hostname||e.host||t.host||"<no host>",o="https"===e.protocol||e.secure||(e.socket||{}).encrypted?"https":"http",i=e.originalUrl||e.url,s=o+"://"+n+i,u=l.parse(i||"",!1).query,p=c.parse(t.cookie||""),h=e.body;return"GET"!==r&&"HEAD"!==r||void 0===h&&(h="<unavailable>"),h&&"string"!=typeof h&&"[object String]"!=={}.toString.call(h)&&(h=a.serialize(h)),{cookies:p,data:h,headers:t,method:r,query_string:u,url:s}}(t))),r.serverName&&(e.server_name=global.process.env.SENTRY_NAME||p.hostname()),r.user&&t.user&&(e.user=n.__assign({},e.user,function(e,t){var r={};(Array.isArray(t)?t:f).forEach(function(t){({}).hasOwnProperty.call(e.user,t)&&(r[t]=e.user[t])});var n=e.ip||e.connection&&e.connection.remoteAddress;return n&&(r.ip_address=n),r}(t,r.user))),r.transaction){var o=function(e,t){try{var r=e;switch(t){case"path":return r.route.path;case"handler":return r.route.stack[0].name;case"methodPath":default:return r.method.toUpperCase()+"|"+r.route.path}}catch(e){return}}(t,r.transaction);o&&(e.transaction=o)}return e}t.parseRequest=d,t.requestHandler=function(e){return function(t,r,i){var s=this,a=u.create();a.add(t),a.add(r),a.on("error",i),a.run(function(){o.getCurrentHub().configureScope(function(r){return r.addEventProcessor(function(r){return n.__awaiter(s,void 0,void 0,function(){return n.__generator(this,function(n){return[2,d(r,t,e)]})})})}),i()})}},t.errorHandler=function(){return function(e,t,r,n){if(function(e){var t=e.status||e.statusCode||e.status_code||e.output&&e.output.statusCode;return t?parseInt(t,10):500}(e)<500)n(e);else{var i=o.captureException(e);r.sentry=i,n(e)}}},t.defaultOnFatalError=function(e){console.error(e&&e.stack?e.stack:e);var t=o.getCurrentHub().getClient().getOptions(),r=t&&t.shutdownTimeout&&t.shutdownTimeout>0&&t.shutdownTimeout||h;i.forget(o.getCurrentHub().getClient().close(r).then(function(e){e||s.logger.warn("We reached the timeout for emptying the request buffer, still exiting now!"),global.process.exit(1)}))}},function(e,t){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,o=e.indexOf("["),i=e.indexOf("]");-1!=o&&-1!=i&&(e=e.substring(0,o)+e.substring(o,i).replace(/:/g,";")+e.substring(i,e.length));for(var s=r.exec(e||""),a={},c=14;c--;)a[n[c]]=s[c]||"";return-1!=o&&-1!=i&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(e,t,r){function n(e){var r;function n(){if(n.enabled){var e=n,o=+new Date,i=o-(r||o);e.diff=i,e.prev=r,e.curr=o,r=o;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;c++;var o=t.formatters[n];if("function"==typeof o){var i=s[c];r=o.call(e,i),s.splice(c,1),c--}return r}),t.formatArgs.call(e,s),(n.log||t.log||console.log.bind(console)).apply(e,s)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),n.destroy=o,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var i=t.instances[r];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(169),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t){e.exports=function(e){return r&&Buffer.isBuffer(e)||n&&(e instanceof ArrayBuffer||o(e))};var r="function"==typeof Buffer&&"function"==typeof Buffer.isBuffer,n="function"==typeof ArrayBuffer,o=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},function(e,t,r){var n=r(172),o=r(78),i=r(21),s=r(42),a=r(79),c=r(80),u=r(11)("socket.io-client:manager"),p=r(77),l=r(184),h=Object.prototype.hasOwnProperty;function f(e,t){if(!(this instanceof f))return new f(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var r=t.parser||s;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=f,f.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)h.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},f.prototype.updateSocketIds=function(){for(var e in this.nsps)h.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},f.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},i(f.prototype),f.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},f.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},f.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},f.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},f.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},f.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},f.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},f.prototype.open=f.prototype.connect=function(e,t){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=n(this.uri,this.opts);var r=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var i=a(r,"open",function(){o.onopen(),e&&e()}),s=a(r,"error",function(t){if(u("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",t),e){var r=new Error("Connection error");r.data=t,e(r)}else o.maybeReconnectOnOpen()});if(!1!==this._timeout){var c=this._timeout;u("connect attempt will timeout after %d",c);var p=setTimeout(function(){u("connect attempt timed out after %d",c),i.destroy(),r.close(),r.emit("error","timeout"),o.emitAll("connect_timeout",c)},c);this.subs.push({destroy:function(){clearTimeout(p)}})}return this.subs.push(i),this.subs.push(s),this},f.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(a(e,"data",c(this,"ondata"))),this.subs.push(a(e,"ping",c(this,"onping"))),this.subs.push(a(e,"pong",c(this,"onpong"))),this.subs.push(a(e,"error",c(this,"onerror"))),this.subs.push(a(e,"close",c(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",c(this,"ondecoded")))},f.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},f.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},f.prototype.ondata=function(e){this.decoder.add(e)},f.prototype.ondecoded=function(e){this.emit("packet",e)},f.prototype.onerror=function(e){u("error",e),this.emitAll("error",e)},f.prototype.socket=function(e,t){var r=this.nsps[e];if(!r){r=new o(this,e,t),this.nsps[e]=r;var n=this;r.on("connecting",i),r.on("connect",function(){r.id=n.generateId(e)}),this.autoConnect&&i()}function i(){~p(n.connecting,r)||n.connecting.push(r)}return r},f.prototype.destroy=function(e){var t=p(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},f.prototype.packet=function(e){u("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(r){for(var n=0;n<r.length;n++)t.engine.write(r[n],e.options);t.encoding=!1,t.processPacketQueue()}))},f.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},f.prototype.cleanup=function(){u("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},f.prototype.close=f.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},f.prototype.onclose=function(e){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},f.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();u("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var r=setTimeout(function(){e.skipReconnect||(u("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(u("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(u("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(r)}})}},f.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,r){var n=r(43),o=r(175),i=r(180),s=r(181);t.polling=function(e){var t=!1,r=!1,s=!1!==e.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,c=location.port;c||(c=a?443:80),t=e.hostname!==location.hostname||c!==e.port,r=e.secure!==a}if(e.xdomain=t,e.xscheme=r,"open"in new n(e)&&!e.forceJSONP)return new o(e);if(!s)throw new Error("JSONP disabled");return new i(e)},t.websocket=s},function(e,t,r){var n=r(44),o=r(32),i=r(22),s=r(33),a=r(76),c=r(11)("engine.io-client:polling");e.exports=p;var u=null!=new(r(43))({xdomain:!1}).responseType;function p(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),n.call(this,e)}s(p,n),p.prototype.name="polling",p.prototype.doOpen=function(){this.poll()},p.prototype.pause=function(e){var t=this;function r(){c("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(c("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){c("pre-pause polling complete"),--n||r()})),this.writable||(c("we are currently writing - waiting to pause"),n++,this.once("drain",function(){c("pre-pause writing complete"),--n||r()}))}else r()},p.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},p.prototype.onData=function(e){var t=this;c("polling got data %s",e);i.decodePayload(e,this.socket.binaryType,function(e,r,n){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},p.prototype.doClose=function(){var e=this;function t(){c("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},p.prototype.write=function(e){var t=this;this.writable=!1;var r=function(){t.writable=!0,t.emit("drain")};i.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,r)})},p.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",r="";return!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(r=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e}},function(e,t,r){var n=r(177),o=Object.prototype.toString,i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.exports=function e(t){if(!t||"object"!=typeof t)return!1;if(n(t)){for(var r=0,o=t.length;r<o;r++)if(e(t[r]))return!0;return!1}if("function"==typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||i&&t instanceof Blob||s&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&e(t[a]))return!0;return!1}},function(e,t,r){"use strict";var n,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i=64,s={},a=0,c=0;function u(e){var t="";do{t=o[e%i]+t,e=Math.floor(e/i)}while(e>0);return t}function p(){var e=u(+new Date);return e!==n?(a=0,n=e):e+"."+u(a++)}for(;c<i;c++)s[o[c]]=c;p.encode=u,p.decode=function(e){var t=0;for(c=0;c<e.length;c++)t=t*i+s[e.charAt(c)];return t},e.exports=p},function(e,t){var r=[].indexOf;e.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},function(e,t,r){var n=r(42),o=r(21),i=r(183),s=r(79),a=r(80),c=r(11)("socket.io-client:socket"),u=r(32),p=r(75);e.exports=f;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},h=o.prototype.emit;function f(e,t,r){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open()}o(f.prototype),f.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",a(this,"onopen")),s(e,"packet",a(this,"onpacket")),s(e,"close",a(this,"onclose"))]}},f.prototype.open=f.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},f.prototype.send=function(){var e=i(arguments);return e.unshift("message"),this.emit.apply(this,e),this},f.prototype.emit=function(e){if(l.hasOwnProperty(e))return h.apply(this,arguments),this;var t=i(arguments),r={type:(void 0!==this.flags.binary?this.flags.binary:p(t))?n.BINARY_EVENT:n.EVENT,data:t,options:{}};return r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),this.flags={},this},f.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},f.prototype.onopen=function(){if(c("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?u.encode(this.query):this.query;c("sending connect packet with query %s",e),this.packet({type:n.CONNECT,query:e})}else this.packet({type:n.CONNECT})},f.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},f.prototype.onpacket=function(e){var t=e.nsp===this.nsp,r=e.type===n.ERROR&&"/"===e.nsp;if(t||r)switch(e.type){case n.CONNECT:this.onconnect();break;case n.EVENT:case n.BINARY_EVENT:this.onevent(e);break;case n.ACK:case n.BINARY_ACK:this.onack(e);break;case n.DISCONNECT:this.ondisconnect();break;case n.ERROR:this.emit("error",e.data)}},f.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?h.apply(this,t):this.receiveBuffer.push(t)},f.prototype.ack=function(e){var t=this,r=!1;return function(){if(!r){r=!0;var o=i(arguments);c("sending ack %j",o),t.packet({type:p(o)?n.BINARY_ACK:n.ACK,id:e,data:o})}}},f.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)},f.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},f.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)h.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},f.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},f.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},f.prototype.close=f.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:n.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},f.prototype.compress=function(e){return this.flags.compress=e,this},f.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t,r){return e.on(t,r),{destroy:function(){e.removeListener(t,r)}}}},function(e,t){var r=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);n.__exportStar(r(188),t),n.__exportStar(r(189),t);var o=r(82);t.HomeyAPI=o.HomeyAPI},function(e,t){e.exports=require("athom-api")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(0).__exportStar(r(191),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);var o;const i=r(8),s=r(1),a=r(24),c=r(6),u=r(25);let p=o=class{constructor(e,t){this.deviceManager=t,this.logger=e.createLogger("ST/Check")}setTargetTemperature(e,t){return n.__awaiter(this,void 0,void 0,function*(){const r=this.logger.createSubLogger(e.id);if(r.debug(`Checking temperature ${t}°`),!e.ready)return r.information(`Device not ready: ${e.unavailableMessage}`),{success:!1,skipped:!0,error:"not_ready"};try{return this.deviceManager.getTargetTemperature(e)!==t?(yield i.Retry(()=>n.__awaiter(this,void 0,void 0,function*(){r.information(`Set temperature to ${t}`),yield this.deviceManager.setTargetTemperature(e,t),r.debug("Done.")}),r,5,1e3,!0,2e4),{success:!0,skipped:!1}):(r.information("Target temperature already set."),{success:!0,skipped:!0})}catch(e){return r.error(e,"Failed to set temperature"),{success:!1,skipped:!1,error:e.name}}})}};n.__decorate([c.trycatchlog(!0,{success:!1,error:"unhandeled"}),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[Object,Number]),n.__metadata("design:returntype",Promise)],p.prototype,"setTargetTemperature",null),p=o=n.__decorate([s.injectable(),s.registry([{token:u.PolicyType.CheckTemperature,useToken:o}]),n.__metadata("design:paramtypes",[c.LoggerFactory,a.DeviceManagerService])],p),t.CheckTemperaturePolicy=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);var o;const i=r(8),s=r(1),a=r(24),c=r(6),u=r(25);let p=o=class{constructor(e,t){this.deviceManager=t,this.logger=e.createLogger("ST/Enforce")}setTargetTemperature(e,t){return n.__awaiter(this,void 0,void 0,function*(){const r=this.logger.createSubLogger(e.id);if(!e.ready)return r.information(`> Device is not ready: ${e.unavailableMessage}`),{success:!1,skipped:!1,error:"not_ready"};try{return yield i.Retry(()=>n.__awaiter(this,void 0,void 0,function*(){r.information(`Set temperature to ${t}`),yield this.deviceManager.setTargetTemperature(e,t),r.debug("Done.")}),r,5,1e3,!0,2e4),{success:!0,skipped:!1}}catch(e){return r.error(e,"Failed to set temperature"),{success:!1,skipped:!1,error:e.name}}})}};n.__decorate([c.trycatchlog(!0,{success:!1,error:"unhandeled"}),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[Object,Number]),n.__metadata("design:returntype",Promise)],p.prototype,"setTargetTemperature",null),p=o=n.__decorate([s.injectable(),s.registry([{token:u.PolicyType.Enforce,useToken:o}]),n.__metadata("design:paramtypes",[c.LoggerFactory,a.DeviceManagerService])],p),t.EnforceTemperaturePolicy=p},,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);n.__exportStar(r(12),t),n.__exportStar(r(6),t),n.__exportStar(r(81),t),n.__exportStar(r(45),t),n.__exportStar(r(83),t),n.__exportStar(r(24),t),n.__exportStar(r(26),t),n.__exportStar(r(46),t),n.__exportStar(r(47),t),n.__exportStar(r(206),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.SentryEnabled="sentry",e.ConsoleReLogCategory="consolere",e.ConsoleReLogEnabled="logenabled",e.Plans="plans",e.NotifyModeChange="notify_modechange",e.NotifySetSuccess="notify_settempsuccess",e.NotifySetError="notify_settemperror"}(t.Settings||(t.Settings={})),function(e){e.OperationMode="mode",e.LogApi="logapi",e.PlanConflictPolicy="planconflictpolicy",e.SetTemperaturePolicy="temperaturepolicy",e.SetTemperatureThrottle="temperatureThrottle",e.SchedulerTimeSlots="schedulerTimeslots",e.DriverDebounce="driverdebounce"}(t.InternalSettings||(t.InternalSettings={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);var o,i;const s=r(5),a=r(49),c=r(1),u=r(6);let p=class{constructor(e){this.onChangedDispatcher=new a.EventDispatcher,this.devSettings={},this.logger=e.createLogger("Settings")}get onChanged(){return this.onChangedDispatcher.asEvent()}get(e,t){let r=s.ManagerSettings.get(e);return null==r&&(r=t),this.logger.debug(`Get '${e}' => '${r}'`),r}set(e,t){this.logger.debug(`Put '${e}' <= '${t}'`);try{null==t?s.ManagerSettings.unset(e):s.ManagerSettings.set(e,t)}finally{this.onChangedDispatcher.dispatch(this,{setting:e,value:t})}}};n.__decorate([u.trycatchlog(),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[String,"function"==typeof(o="undefined"!=typeof T&&T)?o:Object]),n.__metadata("design:returntype",Object)],p.prototype,"get",null),n.__decorate([u.trycatchlog(),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[String,"function"==typeof(i="undefined"!=typeof T&&T)?i:Object]),n.__metadata("design:returntype",void 0)],p.prototype,"set",null),p=n.__decorate([c.singleton(),n.__metadata("design:paramtypes",[u.LoggerFactory])],p),t.SettingsManagerService=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(107),o=r(50),i=function(){function e(){this._wrap=new a(this),this._subscriptions=new Array}return e.prototype.subscribe=function(e){var t=this;return e&&this._subscriptions.push(new o.Subscription(e,!1)),function(){t.unsubscribe(e)}},e.prototype.sub=function(e){return this.subscribe(e)},e.prototype.one=function(e){var t=this;return e&&this._subscriptions.push(new o.Subscription(e,!0)),function(){t.unsubscribe(e)}},e.prototype.has=function(e){return!!e&&this._subscriptions.some(function(t){return t.handler==e})},e.prototype.unsubscribe=function(e){if(e)for(var t=0;t<this._subscriptions.length;t++)if(this._subscriptions[t].handler==e){this._subscriptions.splice(t,1);break}},e.prototype.unsub=function(e){this.unsubscribe(e)},e.prototype._dispatch=function(e,t,r){for(var o=this,i=function(i){var a=new n.EventManagement(function(){return o.unsub(i.handler)}),c=Array.prototype.slice.call(r);if(c.push(a),i.execute(e,t,c),s.cleanup(i),!e&&a.propagationStopped)return"break"},s=this,a=0,c=this._subscriptions.slice();a<c.length;a++){if("break"===i(c[a]))break}},e.prototype.cleanup=function(e){if(e.isOnce&&e.isExecuted){var t=this._subscriptions.indexOf(e);t>-1&&this._subscriptions.splice(t,1)}},e.prototype.asEvent=function(){return this._wrap},e.prototype.clear=function(){this._subscriptions.splice(0,this._subscriptions.length)},e}();t.DispatcherBase=i;var s=function(){function e(){this._events={}}return e.prototype.get=function(e){var t=this._events[e];return t||(t=this.createDispatcher(),this._events[e]=t,t)},e.prototype.remove=function(e){delete this._events[e]},e}();t.EventListBase=s;var a=function(){function e(e){this._subscribe=function(t){return e.subscribe(t)},this._unsubscribe=function(t){return e.unsubscribe(t)},this._one=function(t){return e.one(t)},this._has=function(t){return e.has(t)},this._clear=function(){return e.clear()}}return e.prototype.subscribe=function(e){return this._subscribe(e)},e.prototype.sub=function(e){return this.subscribe(e)},e.prototype.unsubscribe=function(e){this._unsubscribe(e)},e.prototype.unsub=function(e){this.unsubscribe(e)},e.prototype.one=function(e){return this._one(e)},e.prototype.has=function(e){return this._has(e)},e.prototype.clear=function(){this._clear()},e}();t.DispatcherWrapper=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.unsub=e,this.propagationStopped=!1}return e.prototype.stopPropagation=function(){this.propagationStopped=!0},e}();t.EventManagement=n},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(27),s=function(e){function t(){return e.call(this)||this}return o(t,e),t.prototype.dispatch=function(e,t){this._dispatch(!1,this,arguments)},t.prototype.dispatchAsync=function(e,t){this._dispatch(!0,this,arguments)},t.prototype.asEvent=function(){return e.prototype.asEvent.call(this)},t}(i.DispatcherBase);t.EventDispatcher=s;var a=function(e){function t(){return e.call(this)||this}return o(t,e),t.prototype.createDispatcher=function(){return new s},t}(i.EventListBase);t.EventList=a;var c=function(){function e(){this._events=new a}return Object.defineProperty(e.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0}),e.prototype.subscribe=function(e,t){this._events.get(e).subscribe(t)},e.prototype.sub=function(e,t){this.subscribe(e,t)},e.prototype.unsubscribe=function(e,t){this._events.get(e).unsubscribe(t)},e.prototype.unsub=function(e,t){this.unsubscribe(e,t)},e.prototype.one=function(e,t){this._events.get(e).one(t)},e.prototype.has=function(e,t){return this._events.get(e).has(t)},e}();t.EventHandlingBase=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(110);t.SimpleEventDispatcher=n.SimpleEventDispatcher,t.SimpleEventHandlingBase=n.SimpleEventHandlingBase,t.SimpleEventList=n.SimpleEventList},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(27),s=function(e){function t(){return e.call(this)||this}return o(t,e),t.prototype.dispatch=function(e){this._dispatch(!1,this,arguments)},t.prototype.dispatchAsync=function(e){this._dispatch(!0,this,arguments)},t.prototype.asEvent=function(){return e.prototype.asEvent.call(this)},t}(i.DispatcherBase);t.SimpleEventDispatcher=s;var a=function(e){function t(){return e.call(this)||this}return o(t,e),t.prototype.createDispatcher=function(){return new s},t}(i.EventListBase);t.SimpleEventList=a;var c=function(){function e(){this._events=new a}return Object.defineProperty(e.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0}),e.prototype.subscribe=function(e,t){this._events.get(e).subscribe(t)},e.prototype.sub=function(e,t){this.subscribe(e,t)},e.prototype.one=function(e,t){this._events.get(e).one(t)},e.prototype.has=function(e,t){return this._events.get(e).has(t)},e.prototype.unsubscribe=function(e,t){this._events.get(e).unsubscribe(t)},e.prototype.unsub=function(e,t){this.unsubscribe(e,t)},e}();t.SimpleEventHandlingBase=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(112);t.SignalDispatcher=n.SignalDispatcher,t.SignalHandlingBase=n.SignalHandlingBase,t.SignalList=n.SignalList},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(27),s=function(e){function t(){return e.call(this)||this}return o(t,e),t.prototype.dispatch=function(){this._dispatch(!1,this,arguments)},t.prototype.dispatchAsync=function(){this._dispatch(!0,this,arguments)},t.prototype.asEvent=function(){return e.prototype.asEvent.call(this)},t}(i.DispatcherBase);t.SignalDispatcher=s;var a=function(e){function t(){return e.call(this)||this}return o(t,e),t.prototype.createDispatcher=function(){return new s},t}(i.EventListBase);t.SignalList=a;var c=function(){function e(){this._events=new a}return Object.defineProperty(e.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0}),e.prototype.one=function(e,t){this._events.get(e).one(t)},e.prototype.has=function(e,t){return this._events.get(e).has(t)},e.prototype.subscribe=function(e,t){this._events.get(e).subscribe(t)},e.prototype.sub=function(e,t){this.subscribe(e,t)},e.prototype.unsubscribe=function(e,t){this._events.get(e).unsubscribe(t)},e.prototype.unsub=function(e,t){this.unsubscribe(e,t)},e}();t.SignalHandlingBase=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AppLogger=class{constructor(e){this.app=e}information(...e){this.app.log("[INFO ]",...e)}debug(...e){this.app.log("[DEBUG]",...e)}error(e,...t){this.app.error("[ERROR]",...t,e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=e=>"["+e+"m",o=n("39"),i=n("31"),s=n("90"),a=n("33");t.ConsoleLogger=class{information(e,...t){console.log(`${a}${e}`,...t,o)}debug(e,...t){console.log(`${s}${e}`,...t,o)}error(e,t,...r){console.error(`${i}${t}`,...r,e,o)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(116),o=r(5),i=r(23);t.SentryLogger=class{constructor(){this.enabled=!1,null==o.env.SENTRY_DSN||""===o.env.SENTRY_DSN||"do-not-store"===o.env.SENTRY_DSN?i.LogService.transportLog.error(new Error("NO DSN"),"sentry cannot be enabled without a valid DSN, check configuration"):(i.LogService.transportLog.information("sentry has been enabled"),this.enabled=!0,n.init({dsn:o.env.SENTRY_DSN,debug:!1,integrations:e=>e.filter(e=>"Console"!==e.name&&"Http"!==e.name),release:"homey-heating@1.2.1-alpha"}))}teardown(){return this.enabled?(this.enabled=!1,i.LogService.transportLog.information("Sentry cleaned up"),n.close()):Promise.resolve(!0)}information(e,t,...r){this.enabled&&n.addBreadcrumb({category:e,message:t,data:r,level:n.Severity.Info})}debug(e,t,...r){this.enabled&&n.addBreadcrumb({category:e,message:t,data:r,level:n.Severity.Debug})}error(e,...t){this.enabled&&n.configureScope(r=>{r.setExtra("messages",t);const o=n.captureException(e);i.LogService.transportLog.information("Created sentry.io issue",o)})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(17);t.Severity=o.Severity,t.Status=o.Status;var i=r(2);t.addGlobalEventProcessor=i.addGlobalEventProcessor,t.addBreadcrumb=i.addBreadcrumb,t.captureException=i.captureException,t.captureEvent=i.captureEvent,t.captureMessage=i.captureMessage,t.configureScope=i.configureScope,t.getCurrentHub=i.getCurrentHub,t.getHubFromCarrier=i.getHubFromCarrier,t.Hub=i.Hub,t.Scope=i.Scope,t.withScope=i.withScope;var s=r(55);t.NodeBackend=s.NodeBackend;var a=r(63);t.NodeClient=a.NodeClient;var c=r(154);t.defaultIntegrations=c.defaultIntegrations,t.init=c.init,t.flush=c.flush,t.close=c.close;var u=r(39);t.SDK_NAME=u.SDK_NAME,t.SDK_VERSION=u.SDK_VERSION;var p=r(2),l=r(67);t.Handlers=l;var h=r(65),f=r(37);t.Parsers=f;var d=r(57);t.Transports=d;var g=n.__assign({},p.Integrations,h);t.Integrations=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9);function i(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var i=o.getCurrentHub();if(i&&i[e])return i[e].apply(i,n.__spread(t));throw new Error("No hub defined or "+e+" was not found on the hub, please open a bug report.")}t.captureException=function(e){var t;try{throw new Error("Sentry syntheticException")}catch(e){t=e}return i("captureException",e,{originalException:e,syntheticException:t})},t.captureMessage=function(e,t){var r;try{throw new Error(e)}catch(e){r=e}return i("captureMessage",e,t,{originalException:e,syntheticException:r})},t.captureEvent=function(e){return i("captureEvent",e)},t.addBreadcrumb=function(e){i("addBreadcrumb",e)},t.configureScope=function(e){i("configureScope",e)},t.withScope=function(e){i("withScope",e)},t._callOnClient=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];i.apply(void 0,n.__spread(["invokeClient",e],t))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.hasWeakSet="function"==typeof WeakSet,this.inner=this.hasWeakSet?new WeakSet:[]}return e.prototype.memoize=function(e){if(this.hasWeakSet)return!!this.inner.has(e)||(this.inner.add(e),!1);for(var t=0;t<this.inner.length;t++){if(this.inner[t]===e)return!0}return this.inner.push(e),!1},e.prototype.unmemoize=function(e){if(this.hasWeakSet)this.inner.delete(e);else for(var t=0;t<this.inner.length;t++)if(this.inner[t]===e){this.inner.splice(t,1);break}},e}();t.Memo=n},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(19),s=r(51);t.API_VERSION=3;var a=function(){function e(e,r,n){void 0===r&&(r=new s.Scope),void 0===n&&(n=t.API_VERSION),this.version=n,this.stack=[],this.stack.push({client:e,scope:r})}return e.prototype.invokeClient=function(e){for(var t,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var i=this.getStackTop();i&&i.client&&i.client[e]&&(t=i.client)[e].apply(t,n.__spread(r,[i.scope]))},e.prototype.invokeClientAsync=function(e){for(var t,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var s=this.getStackTop();s&&s.client&&s.client[e]&&(t=s.client)[e].apply(t,n.__spread(r,[s.scope])).catch(function(e){o.logger.error(e)})},e.prototype.isOlderThan=function(e){return this.version<e},e.prototype.bindClient=function(e){var t=this.getStackTop();t.client=e,t&&t.scope&&e&&t.scope.addScopeListener(function(t){if(e.getBackend)try{e.getBackend().storeScope(t)}catch(e){}})},e.prototype.pushScope=function(){var e=this.getStack(),t=e.length>0?e[e.length-1].scope:void 0,r=s.Scope.clone(t);return this.getStack().push({client:this.getClient(),scope:r}),r},e.prototype.popScope=function(){return void 0!==this.getStack().pop()},e.prototype.withScope=function(e){var t=this.pushScope();try{e(t)}finally{this.popScope()}},e.prototype.getClient=function(){return this.getStackTop().client},e.prototype.getScope=function(){return this.getStackTop().scope},e.prototype.getStack=function(){return this.stack},e.prototype.getStackTop=function(){return this.stack[this.stack.length-1]},e.prototype.captureException=function(e,t){var r=this._lastEventId=i.uuid4();return this.invokeClientAsync("captureException",e,n.__assign({},t,{event_id:r})),r},e.prototype.captureMessage=function(e,t,r){var o=this._lastEventId=i.uuid4();return this.invokeClientAsync("captureMessage",e,t,n.__assign({},r,{event_id:o})),o},e.prototype.captureEvent=function(e,t){var r=this._lastEventId=i.uuid4();return this.invokeClientAsync("captureEvent",e,n.__assign({},t,{event_id:r})),r},e.prototype.lastEventId=function(){return this._lastEventId},e.prototype.addBreadcrumb=function(e,t){this.invokeClient("addBreadcrumb",e,n.__assign({},t))},e.prototype.configureScope=function(e){var t=this.getStackTop();t.scope&&t.client&&e(t.scope)},e.prototype.run=function(e){var t=u(this);try{e(this)}finally{u(t)}},e.prototype.getIntegration=function(e){try{return this.getClient().getIntegration(e)}catch(t){return o.logger.warn("Cannot retrieve integration "+e.id+" from the current Hub"),null}},e}();function c(){var e=i.getGlobalObject();return e.__SENTRY__=e.__SENTRY__||{hub:void 0},e}function u(e){var t=c(),r=l(t);return h(t,e),r}function p(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function l(e){return e&&e.__SENTRY__&&e.__SENTRY__.hub?e.__SENTRY__.hub:(e.__SENTRY__={},e.__SENTRY__.hub=new a,e.__SENTRY__.hub)}function h(e,t){return!!e&&(e.__SENTRY__=e.__SENTRY__||{},e.__SENTRY__.hub=t,!0)}t.Hub=a,t.getMainCarrier=c,t.makeMain=u,t.getCurrentHub=function(){var r=c();p(r)&&!l(r).isOlderThan(t.API_VERSION)||h(r,new a);try{var n=i.dynamicRequire(e,"domain").active;if(!n)return l(r);if(!p(n)||l(n).isOlderThan(t.API_VERSION)){var o=l(r).getStackTop();h(n,new a(o.client,s.Scope.clone(o.scope)))}return l(n)}catch(e){return l(r)}},t.hasHubOnCarrier=p,t.getHubFromCarrier=l,t.setHubOnCarrier=h}).call(this,r(120)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),o=r(35),i=function(){function e(e){this.dsn=e,this.dsnObject=new o.Dsn(e)}return e.prototype.getDsn=function(){return this.dsnObject},e.prototype.getStoreEndpoint=function(){return""+this.getBaseUrl()+this.getStoreEndpointPath()},e.prototype.getStoreEndpointWithUrlEncodedAuth=function(){var e={sentry_key:this.dsnObject.user,sentry_version:"7"};return this.getStoreEndpoint()+"?"+n.urlEncode(e)},e.prototype.getBaseUrl=function(){var e=this.dsnObject,t=e.protocol?e.protocol+":":"",r=e.port?":"+e.port:"";return t+"//"+e.host+r},e.prototype.getStoreEndpointPath=function(){var e=this.dsnObject;return(e.path?"/"+e.path:"")+"/api/"+e.projectId+"/store/"},e.prototype.getRequestHeaders=function(e,t){var r=this.dsnObject,n=["Sentry sentry_version=7"];return n.push("sentry_timestamp="+(new Date).getTime()),n.push("sentry_client="+e+"/"+t),n.push("sentry_key="+r.user),r.pass&&n.push("sentry_secret="+r.pass),{"Content-Type":"application/json","X-Sentry-Auth":n.join(", ")}},e.prototype.getReportDialogEndpoint=function(e){void 0===e&&(e={});var t=this.dsnObject,r=this.getBaseUrl()+(t.path?"/"+t.path:"")+"/api/embed/error-page/",n=[];for(var o in n.push("dsn="+t.toString()),e)if("user"===o){if(!e.user)continue;e.user.name&&n.push("name="+encodeURIComponent(e.user.name)),e.user.email&&n.push("email="+encodeURIComponent(e.user.email))}else n.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return n.length?r+"?"+n.join("&"):r},e}();t.API=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(17),i=r(52),s=r(13),a=r(7),c=r(19),u=r(28),p=r(35),l=r(123),h=r(36),f=function(){function e(e,t){this.buffer=new h.PromiseBuffer,this.backend=new e(t),this.options=t,t.dsn&&(this.dsn=new p.Dsn(t.dsn)),this.integrations=l.setupIntegrations(this.options)}return e.prototype.install=function(){if(!this.isEnabled())return this.installed=!1;var e=this.getBackend();return!this.installed&&e.install&&e.install(),this.installed=!0},e.prototype.captureException=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var o=this;return n.__generator(this,function(i){return[2,this.buffer.add(n.__awaiter(o,void 0,void 0,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this.getBackend().eventFromException(e,t)];case 1:return o=n.sent(),[2,this.captureEvent(o,t,r)]}})}))]})})},e.prototype.captureMessage=function(e,t,r,o){return n.__awaiter(this,void 0,void 0,function(){var i=this;return n.__generator(this,function(a){return[2,this.buffer.add(n.__awaiter(i,void 0,void 0,function(){var i,a;return n.__generator(this,function(n){switch(n.label){case 0:return s.isPrimitive(e)?[4,this.getBackend().eventFromMessage(""+e,t,r)]:[3,2];case 1:return a=n.sent(),[3,4];case 2:return[4,this.getBackend().eventFromException(e,r)];case 3:a=n.sent(),n.label=4;case 4:return i=a,[2,this.captureEvent(i,r,o)]}})}))]})})},e.prototype.captureEvent=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var o=this;return n.__generator(this,function(i){return[2,this.buffer.add(n.__awaiter(o,void 0,void 0,function(){var o=this;return n.__generator(this,function(i){return[2,this.processEvent(e,function(e){return n.__awaiter(o,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.getBackend().sendEvent(e)]})})},t,r)]})}))]})})},e.prototype.addBreadcrumb=function(e,t,r){var o=this.getOptions(),i=o.beforeBreadcrumb,s=o.maxBreadcrumbs,a=void 0===s?30:s;if(!(a<=0)){var u=(new Date).getTime()/1e3,p=n.__assign({timestamp:u},e),l=i?c.consoleSandbox(function(){return i(p,t)}):p;null!==l&&this.getBackend().storeBreadcrumb(l)&&r&&r.addBreadcrumb(l,Math.min(a,100))}},e.prototype.getDsn=function(){return this.dsn},e.prototype.getOptions=function(){return this.options},e.prototype.getBackend=function(){return this.backend},e.prototype.isEnabled=function(){return!1!==this.getOptions().enabled&&void 0!==this.dsn},e.prototype.prepareEvent=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var o,i,s,a,p,l,h,f,d;return n.__generator(this,function(g){return o=this.getOptions(),i=o.environment,s=o.maxBreadcrumbs,a=void 0===s?30:s,p=o.release,l=o.dist,void 0===(h=n.__assign({},e)).environment&&void 0!==i&&(h.environment=i),void 0===h.release&&void 0!==p&&(h.release=p),void 0===h.dist&&void 0!==l&&(h.dist=l),h.message&&(h.message=u.truncate(h.message,250)),(f=h.exception&&h.exception.values&&h.exception.values[0])&&f.value&&(f.value=u.truncate(f.value,250)),(d=h.request)&&d.url&&(d.url=u.truncate(d.url,250)),void 0===h.event_id&&(h.event_id=c.uuid4()),t?[2,t.applyToEvent(h,r,Math.min(a,100))]:[2,h]})})},e.prototype.processEvent=function(e,t,r,s){return n.__awaiter(this,void 0,void 0,function(){var c,u,p,l,h,f,d,g;return n.__generator(this,function(n){switch(n.label){case 0:return this.isEnabled()?(c=this.getOptions(),u=c.beforeSend,"number"==typeof(p=c.sampleRate)&&Math.random()>p?[2,{status:o.Status.Skipped}]:[4,this.prepareEvent(e,s,r)]):[2,{status:o.Status.Skipped}];case 1:if(null===(l=n.sent()))return[2,{status:o.Status.Skipped}];h=l,n.label=2;case 2:return n.trys.push([2,5,,6]),r&&r.data&&!0===r.data.__sentry__||!u?[3,4]:[4,u(l,r)];case 3:void 0===(h=n.sent())&&a.logger.error("`beforeSend` method has to return `null` or a valid event"),n.label=4;case 4:return[3,6];case 5:return f=n.sent(),i.forget(this.captureException(f,{data:{__sentry__:!0},originalException:f})),[2,{reason:"Event processing in beforeSend method threw an exception",status:o.Status.Invalid}];case 6:if(null===h)return[2,{reason:"Event dropped due to being discarded by beforeSend method",status:o.Status.Skipped}];n.label=7;case 7:return n.trys.push([7,9,,10]),[4,t(h)];case 8:return(d=n.sent()).event=h,d.status,o.Status.RateLimit,[2,d];case 9:return g=n.sent(),a.logger.error(""+g),[2,{reason:""+g,status:o.Status.Failed}];case 10:return[2]}})})},e.prototype.flush=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.getBackend().getTransport().close(e),this.buffer.drain(e)])];case 1:return[2,t.sent().reduce(function(e,t){return e&&t})]}})})},e.prototype.close=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.flush(e)]})})},e.prototype.getIntegrations=function(){return this.integrations||{}},e.prototype.getIntegration=function(e){try{return this.integrations[e.id]||null}catch(t){return a.logger.warn("Cannot retrieve integration "+e.id+" from the current Client"),null}},e}();t.BaseClient=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7);function i(e){var t,r,o,i,s=e.defaultIntegrations&&n.__spread(e.defaultIntegrations)||[],c=e.integrations,u=[];if(Array.isArray(c)){var p=c.map(function(e){return e.name}),l=[];try{for(var h=n.__values(s),f=h.next();!f.done;f=h.next()){var d=f.value;-1===p.indexOf(a(d))&&-1===l.indexOf(a(d))&&(u.push(d),l.push(a(d)))}}catch(e){t={error:e}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(t)throw t.error}}try{for(var g=n.__values(c),y=g.next();!y.done;y=g.next()){var v=y.value;-1===l.indexOf(a(v))&&(u.push(v),l.push(a(v)))}}catch(e){o={error:e}}finally{try{y&&!y.done&&(i=g.return)&&i.call(g)}finally{if(o)throw o.error}}}else{if("function"!=typeof c)return n.__spread(s);u=c(s),u=Array.isArray(u)?u:[u]}return u}function s(e,r){if(-1===t.installedIntegrations.indexOf(a(e))){try{e.setupOnce()}catch(t){e.install&&(o.logger.warn("Integration "+a(e)+': The install method is deprecated. Use "setupOnce".'),e.install(r))}t.installedIntegrations.push(a(e)),o.logger.log("Integration installed: "+a(e))}}function a(e){return e.constructor.id||e.name}t.installedIntegrations=[],t.getIntegrationsToSetup=i,t.setupIntegration=s,t.setupIntegrations=function(e){var t={};return i(e).forEach(function(r){t[a(r)]=r,s(r,e)}),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(10),s=r(29),a=r(53),c=function(){function e(e){this.options=e,this.options.dsn||o.logger.warn("No DSN provided, backend will not do anything."),this.transport=this.setupTransport()}return e.prototype.setupTransport=function(){return new a.NoopTransport},e.prototype.eventFromException=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){throw new s.SentryError("Backend has to implement `eventFromException` method")})})},e.prototype.eventFromMessage=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){throw new s.SentryError("Backend has to implement `eventFromMessage` method")})})},e.prototype.sendEvent=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return this.transport.captureEvent?[2,this.transport.captureEvent(e)]:[2,this.transport.sendEvent(i.serialize(e))]})})},e.prototype.storeBreadcrumb=function(e){return!0},e.prototype.storeScope=function(e){},e.prototype.getTransport=function(){return this.transport},e}();t.BaseBackend=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Debug=2]="Debug",e[e.Verbose=3]="Verbose"}(t.LogLevel||(t.LogLevel={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),o=r(7);t.initAndBind=function(e,t){!0===t.debug&&o.logger.enable();var r=new e(t);n.getCurrentHub().bindClient(r),r.install()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(128);t.Dedupe=n.Dedupe;var o=r(129);t.FunctionToString=o.FunctionToString;var i=r(130);t.SDKInformation=i.SDKInformation;var s=r(131);t.InboundFilters=s.InboundFilters;var a=r(132);t.ExtraErrorData=a.ExtraErrorData;var c=r(133);t.Debug=c.Debug;var u=r(134);t.RewriteFrames=u.RewriteFrames},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9),i=r(7),s=r(19),a=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){var t=this;o.addGlobalEventProcessor(function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){if(t=o.getCurrentHub().getIntegration(e)){try{if(t.shouldDropEvent(r,t.previousEvent))return[2,null]}catch(e){return[2,t.previousEvent=r]}return[2,t.previousEvent=r]}return[2,r]})})})},e.prototype.shouldDropEvent=function(e,t){return!!t&&(this.isSameMessageEvent(e,t)?(i.logger.warn("Event dropped due to being a duplicate of previous event (same message).\nEvent: "+s.getEventDescription(e)),!0):!!this.isSameExceptionEvent(e,t)&&(i.logger.warn("Event dropped due to being a duplicate of previous event (same exception).\nEvent: "+s.getEventDescription(e)),!0))},e.prototype.isSameMessageEvent=function(e,t){var r=e.message,n=t.message;return!(!r&&!n)&&(!(r&&!n||!r&&n)&&(r===n&&(!!this.isSameFingerprint(e,t)&&!!this.isSameStacktrace(e,t))))},e.prototype.getFramesFromEvent=function(e){var t=e.exception;if(!t)return e.stacktrace?e.stacktrace.frames:void 0;try{return t.values[0].stacktrace.frames}catch(e){return}},e.prototype.isSameStacktrace=function(e,t){var r=this.getFramesFromEvent(e),n=this.getFramesFromEvent(t);if(!r&&!n)return!0;if(r&&!n||!r&&n)return!1;if(r=r,(n=n).length!==r.length)return!1;for(var o=0;o<n.length;o++){var i=n[o],s=r[o];if(i.filename!==s.filename||i.lineno!==s.lineno||i.colno!==s.colno||i.function!==s.function)return!1}return!0},e.prototype.getExceptionFromEvent=function(e){return e.exception&&e.exception.values&&e.exception.values[0]},e.prototype.isSameExceptionEvent=function(e,t){var r=this.getExceptionFromEvent(t),n=this.getExceptionFromEvent(e);return!(!r||!n)&&(r.type===n.type&&r.value===n.value&&(!!this.isSameFingerprint(e,t)&&!!this.isSameStacktrace(e,t)))},e.prototype.isSameFingerprint=function(e,t){var r=e.fingerprint,n=t.fingerprint;if(!r&&!n)return!0;if(r&&!n||!r&&n)return!1;r=r,n=n;try{return!(r.join("")!==n.join(""))}catch(e){return!1}},e.id="Dedupe",e}();t.Dedupe=a},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){n=Function.prototype.toString,Function.prototype.toString=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.__sentry__?this.__sentry_original__:this;return n.apply(r,e)}},e.id="FunctionToString",e}();t.FunctionToString=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=function(){function e(){this.name="SDKInformation"}return e.prototype.setupOnce=function(){n.logger.warn("SDKInformation Integration is deprecated and can be safely removed. It's functionality has been merged into the SDK's core.")},e}();t.SDKInformation=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9),i=r(13),s=r(7),a=r(19),c=r(28),u=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],p=function(){function e(t){void 0===t&&(t={}),this.options=t,this.name=e.id}return e.prototype.setupOnce=function(){var t=this;o.addGlobalEventProcessor(function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,s,a,c;return n.__generator(this,function(n){return(t=o.getCurrentHub())&&(i=t.getIntegration(e))&&(s=t.getClient(),a=s?s.getOptions():{},c=i.mergeOptions(a),i.shouldDropEvent(r,c))?[2,null]:[2,r]})})})},e.prototype.shouldDropEvent=function(e,t){return this.isSentryError(e,t)?(s.logger.warn("Event dropped due to being internal Sentry Error.\nEvent: "+a.getEventDescription(e)),!0):this.isIgnoredError(e,t)?(s.logger.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: "+a.getEventDescription(e)),!0):this.isBlacklistedUrl(e,t)?(s.logger.warn("Event dropped due to being matched by `blacklistUrls` option.\nEvent: "+a.getEventDescription(e)+".\nUrl: "+this.getEventFilterUrl(e)),!0):!this.isWhitelistedUrl(e,t)&&(s.logger.warn("Event dropped due to not being matched by `whitelistUrls` option.\nEvent: "+a.getEventDescription(e)+".\nUrl: "+this.getEventFilterUrl(e)),!0)},e.prototype.isSentryError=function(e,t){if(void 0===t&&(t={}),!t.ignoreInternal)return!1;try{return"SentryError"===e.exception.values[0].type}catch(e){return!1}},e.prototype.isIgnoredError=function(e,t){var r=this;return void 0===t&&(t={}),!(!t.ignoreErrors||!t.ignoreErrors.length)&&this.getPossibleEventMessages(e).some(function(e){return t.ignoreErrors.some(function(t){return r.isMatchingPattern(e,t)})})},e.prototype.isBlacklistedUrl=function(e,t){var r=this;if(void 0===t&&(t={}),!t.blacklistUrls||!t.blacklistUrls.length)return!1;var n=this.getEventFilterUrl(e);return!!n&&t.blacklistUrls.some(function(e){return r.isMatchingPattern(n,e)})},e.prototype.isWhitelistedUrl=function(e,t){var r=this;if(void 0===t&&(t={}),!t.whitelistUrls||!t.whitelistUrls.length)return!0;var n=this.getEventFilterUrl(e);return!n||t.whitelistUrls.some(function(e){return r.isMatchingPattern(n,e)})},e.prototype.mergeOptions=function(e){return void 0===e&&(e={}),{blacklistUrls:n.__spread(this.options.blacklistUrls||[],e.blacklistUrls||[]),ignoreErrors:n.__spread(this.options.ignoreErrors||[],e.ignoreErrors||[],u),ignoreInternal:void 0===this.options.ignoreInternal||this.options.ignoreInternal,whitelistUrls:n.__spread(this.options.whitelistUrls||[],e.whitelistUrls||[])}},e.prototype.isMatchingPattern=function(e,t){return i.isRegExp(t)?t.test(e):"string"==typeof t&&c.includes(e,t)},e.prototype.getPossibleEventMessages=function(e){if(e.message)return[e.message];if(!e.exception)return[];try{var t=e.exception.values[0],r=t.type,n=t.value;return[""+n,r+": "+n]}catch(t){return s.logger.error("Cannot extract message for event "+a.getEventDescription(e)),[]}},e.prototype.getEventFilterUrl=function(e){try{if(e.stacktrace){var t=e.stacktrace.frames;return t[t.length-1].filename}if(e.exception){var r=e.exception.values[0].stacktrace.frames;return r[r.length-1].filename}return null}catch(t){return s.logger.error("Cannot extract url for event "+a.getEventDescription(e)),null}},e.id="InboundFilters",e}();t.InboundFilters=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9),i=r(13),s=r(7),a=r(10),c=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){var t=this;o.addGlobalEventProcessor(function(r,i){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){return(t=o.getCurrentHub().getIntegration(e))?[2,t.enhanceEventWithErrorData(r,i)]:[2,r]})})})},e.prototype.enhanceEventWithErrorData=function(e,t){if(!t||!t.originalException||!i.isError(t.originalException))return e;var r=this.extractErrorData(t.originalException);if(r){var o=n.__assign({},e.extra),s=a.safeNormalize(r);return i.isString(s)||(o=n.__assign({},e.extra,s)),n.__assign({},e,{extra:o})}return e},e.prototype.extractErrorData=function(e){var t,r,o,a=null;try{var c=["name","message","stack","line","column","fileName","lineNumber","columnNumber"],u=e.name||e.constructor.name,p=Object.getOwnPropertyNames(e).filter(function(e){return-1===c.indexOf(e)});if(p.length){var l={};try{for(var h=n.__values(p),f=h.next();!f.done;f=h.next()){var d=f.value,g=e[d];i.isError(g)&&(g=g.name||g.constructor.name),l[d]=g}}catch(e){t={error:e}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(t)throw t.error}}(o={})[u]=l,a=o}}catch(e){s.logger.error("Unable to extract extra data from the Error object:",e)}return a},e.id="ExtraErrorData",e}();t.ExtraErrorData=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9),i=function(){function e(t){this.name=e.id,this.options=n.__assign({debugger:!1,stringify:!1},t)}return e.prototype.setupOnce=function(){var t=this;o.addGlobalEventProcessor(function(r,i){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){return(t=o.getCurrentHub().getIntegration(e))&&(t.options.debugger,t.options.stringify?(console.log(JSON.stringify(r,null,2)),i&&console.log(JSON.stringify(i,null,2))):(console.log(r),i&&console.log(i))),[2,r]})})})},e.id="Debug",e}();t.Debug=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9),i=r(54),s=function(){function e(t){void 0===t&&(t={});var r=this;this.name=e.id,this.iteratee=function(e){return n.__awaiter(r,void 0,void 0,function(){var t;return n.__generator(this,function(r){return e.filename&&e.filename.startsWith("/")&&(t=this.root?i.relative(this.root,e.filename):i.basename(e.filename),e.filename="app:///"+t),[2,e]})})},t.root&&(this.root=t.root),t.iteratee&&(this.iteratee=t.iteratee)}return e.prototype.setupOnce=function(){var t=this;o.addGlobalEventProcessor(function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){return(t=o.getCurrentHub().getIntegration(e))?[2,t.process(r)]:[2,r]})})})},e.prototype.process=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,o,i,s,a,c;return n.__generator(this,function(n){switch(n.label){case 0:if(!(t=this.getFramesFromEvent(e)))return[3,4];for(o in r=[],t)r.push(o);i=0,n.label=1;case 1:return i<r.length?(s=r[i],a=t,c=s,[4,this.iteratee(t[s])]):[3,4];case 2:a[c]=n.sent(),n.label=3;case 3:return i++,[3,1];case 4:return[2,e]}})})},e.prototype.getFramesFromEvent=function(e){var t=e.exception;if(!t)return e.stacktrace?e.stacktrace.frames:void 0;try{return t.values[0].stacktrace.frames}catch(e){return}},e.id="RewriteFrames",e}();t.RewriteFrames=s},function(e,t){e.exports=require("crypto")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(30),i=r(56),s=parseInt("0777",8);function a(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(r){return[2,new Promise(function(r,n){o.mkdir(e,t,function(e){e?n(e):r()})})]})})}t.readFileAsync=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,new Promise(function(t,r){o.readFile(e,"utf8",function(e,n){e?r(e):t(n)})})]})})},t.mkdirp=function e(t){return n.__awaiter(this,void 0,void 0,function(){var r,c,u,p;return n.__generator(this,function(n){switch(n.label){case 0:r=s&~process.umask(),c=i.resolve(t),n.label=1;case 1:return n.trys.push([1,2,,6]),[2,a(c,r)];case 2:return u=n.sent(),(p=u)&&"ENOENT"===p.code?[4,e(i.dirname(c))]:[3,4];case 3:return n.sent(),[2,a(c,r)];case 4:try{if(!o.statSync(c).isDirectory())throw u}catch(e){throw u}n.label=5;case 5:return[3,6];case 6:return[2]}})})},t.mkdirpSync=function e(t){var r=s&~process.umask(),n=i.resolve(t);try{o.mkdirSync(n,r)}catch(t){if(t&&"ENOENT"===t.code)e(i.dirname(n)),o.mkdirSync(n,r);else try{if(!o.statSync(n).isDirectory())throw t}catch(e){throw t}}}},function(e,t,r){var n,o;!function(i,s){const a=t;!function(e){const t=Symbol("newer"),r=Symbol("older");function n(e,t){"number"!=typeof e&&(t=e,e=0),this.size=0,this.limit=e,this.oldest=this.newest=void 0,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}function o(e,n){this.key=e,this.value=n,this[t]=void 0,this[r]=void 0}function i(e){this.entry=e}function s(e){this.entry=e}function a(e){this.entry=e}e.LRUMap=n,n.prototype._markEntryAsUsed=function(e){e!==this.newest&&(e[t]&&(e===this.oldest&&(this.oldest=e[t]),e[t][r]=e[r]),e[r]&&(e[r][t]=e[t]),e[t]=void 0,e[r]=this.newest,this.newest&&(this.newest[t]=e),this.newest=e)},n.prototype.assign=function(e){let n,i=this.limit||Number.MAX_VALUE;this._keymap.clear();let s=e[Symbol.iterator]();for(let e=s.next();!e.done;e=s.next()){let s=new o(e.value[0],e.value[1]);if(this._keymap.set(s.key,s),n?(n[t]=s,s[r]=n):this.oldest=s,n=s,0==i--)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size},n.prototype.get=function(e){var t=this._keymap.get(e);if(t)return this._markEntryAsUsed(t),t.value},n.prototype.set=function(e,n){var i=this._keymap.get(e);return i?(i.value=n,this._markEntryAsUsed(i),this):(this._keymap.set(e,i=new o(e,n)),this.newest?(this.newest[t]=i,i[r]=this.newest):this.oldest=i,this.newest=i,++this.size,this.size>this.limit&&this.shift(),this)},n.prototype.shift=function(){var e=this.oldest;if(e)return this.oldest[t]?(this.oldest=this.oldest[t],this.oldest[r]=void 0):(this.oldest=void 0,this.newest=void 0),e[t]=e[r]=void 0,this._keymap.delete(e.key),--this.size,[e.key,e.value]},n.prototype.find=function(e){let t=this._keymap.get(e);return t?t.value:void 0},n.prototype.has=function(e){return this._keymap.has(e)},n.prototype.delete=function(e){var n=this._keymap.get(e);if(n)return this._keymap.delete(n.key),n[t]&&n[r]?(n[r][t]=n[t],n[t][r]=n[r]):n[t]?(n[t][r]=void 0,this.oldest=n[t]):n[r]?(n[r][t]=void 0,this.newest=n[r]):this.oldest=this.newest=void 0,this.size--,n.value},n.prototype.clear=function(){this.oldest=this.newest=void 0,this.size=0,this._keymap.clear()},i.prototype[Symbol.iterator]=function(){return this},i.prototype.next=function(){let e=this.entry;return e?(this.entry=e[t],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}},s.prototype[Symbol.iterator]=function(){return this},s.prototype.next=function(){let e=this.entry;return e?(this.entry=e[t],{done:!1,value:e.key}):{done:!0,value:void 0}},a.prototype[Symbol.iterator]=function(){return this},a.prototype.next=function(){let e=this.entry;return e?(this.entry=e[t],{done:!1,value:e.value}):{done:!0,value:void 0}},n.prototype.keys=function(){return new s(this.oldest)},n.prototype.values=function(){return new a(this.oldest)},n.prototype.entries=function(){return this},n.prototype[Symbol.iterator]=function(){return new i(this.oldest)},n.prototype.forEach=function(e,r){"object"!=typeof r&&(r=this);let n=this.oldest;for(;n;)e.call(r,n.value,n.key,this),n=n[t]},n.prototype.toJSON=function(){for(var e=new Array(this.size),r=0,n=this.oldest;n;)e[r++]={key:n.key,value:n.value},n=n[t];return e},n.prototype.toString=function(){for(var e="",r=this.oldest;r;)e+=String(r.key)+":"+r.value,(r=r[t])&&(e+=" < ");return e}}(a),void 0===(o="function"==typeof(n=a)?n.call(t,r,t,e):n)||(e.exports=o)}()},function(e,t){function r(e){for(var t in e)this[t]=e[t]}t.get=function(e){var r=Error.stackTraceLimit;Error.stackTraceLimit=1/0;var n={},o=Error.prepareStackTrace;Error.prepareStackTrace=function(e,t){return t},Error.captureStackTrace(n,e||t.get);var i=n.stack;return Error.prepareStackTrace=o,Error.stackTraceLimit=r,i},t.parse=function(e){if(!e.stack)return[];var t=this;return e.stack.split("\n").slice(1).map(function(e){if(e.match(/^\s*[-]{4,}$/))return t._createParsedCallSite({fileName:e,lineNumber:null,functionName:null,typeName:null,methodName:null,columnNumber:null,native:null});var r=e.match(/at (?:(.+)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/);if(r){var n=null,o=null,i=null,s=null,a=null,c="native"===r[5];if(r[1]){var u=(i=r[1]).lastIndexOf(".");if("."==i[u-1]&&u--,u>0){n=i.substr(0,u),o=i.substr(u+1);var p=n.indexOf(".Module");p>0&&(i=i.substr(p+1),n=n.substr(0,p))}s=null}o&&(s=n,a=o),"<anonymous>"===o&&(a=null,i=null);var l={fileName:r[2]||null,lineNumber:parseInt(r[3],10)||null,functionName:i,typeName:s,methodName:a,columnNumber:parseInt(r[4],10)||null,native:c};return t._createParsedCallSite(l)}}).filter(function(e){return!!e})};["this","typeName","functionName","methodName","fileName","lineNumber","columnNumber","function","evalOrigin"].forEach(function(e){r.prototype[e]=null,r.prototype["get"+e[0].toUpperCase()+e.substr(1)]=function(){return this[e]}}),["topLevel","eval","native","constructor"].forEach(function(e){r.prototype[e]=!1,r.prototype["is"+e[0].toUpperCase()+e.substr(1)]=function(){return this[e]}}),t._createParsedCallSite=function(e){return new r(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=r(40),s=r(58),a=function(e){function t(t){var r=e.call(this,t)||this;r.options=t,r.module=i;var n=t.httpProxy||process.env.http_proxy;return r.client=n?new s(n):new i.Agent({keepAlive:!1,maxSockets:30,timeout:2e3}),r}return n.__extends(t,e),t.prototype.sendEvent=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){if(!this.module)throw new o.SentryError("No module available in HTTPTransport");return[2,this.sendWithModule(this.module,e)]})})},t}(r(38).BaseTransport);t.HTTPTransport=a},function(e,t){e.exports=require("net")},function(e,t){e.exports=require("tls")},function(e,t,r){"use strict";r(143);const n=r(20).inherits,o=r(144),i=r(147).EventEmitter;function s(e,t){if(!(this instanceof s))return new s(e,t);i.call(this),this._promisifiedCallback=!1;let r=t;"function"==typeof e?this.callback=e:e&&(r=e),this.timeout=r&&r.timeout||null,this.options=r}e.exports=s,n(s,i),s.prototype.callback=function(e,t){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')},s.prototype.addRequest=function(e,t){const r=Object.assign({},t);null==r.host&&(r.host="localhost"),null==r.port&&(r.port=r.secureEndpoint?443:80);const n=Object.assign({},this.options,r);let i;n.host&&n.path&&delete n.path,delete n.agent,delete n.hostname,delete n._defaultAgent,delete n.defaultPort,delete n.createConnection,e._last=!0,e.shouldKeepAlive=!1;let s=!1;const a=this.timeout,c=this.freeSocket;function u(t){e._hadError||(e.emit("error",t),e._hadError=!0)}function p(e){s||(null!=i&&(clearTimeout(i),i=null),u(e))}!this._promisifiedCallback&&this.callback.length>=3&&(this.callback=o(this.callback,this),this._promisifiedCallback=!0),a>0&&(i=setTimeout(function(){i=null,s=!0;const e=new Error('A "socket" was not created for HTTP request before '+a+"ms");e.code="ETIMEOUT",u(e)},a));try{Promise.resolve(this.callback(e,n)).then(function(t){var r;s||(null!=i&&(clearTimeout(i),i=null),(r=t)&&"function"==typeof r.addRequest?t.addRequest(e,n):t?(t.on("free",function(){c(t,n)}),e.onSocket(t)):u(new Error("no Duplex stream was returned to agent-base for `"+e.method+" "+e.path+"`")))},p)}catch(e){Promise.reject(e).catch(p)}},s.prototype.freeSocket=function(e,t){e.destroy()}},function(e,t,r){"use strict";const n=r(31),o=r(41);var i;o.request=(i=o.request,function(e,t){let r;return null==(r="string"==typeof e?n.parse(e):Object.assign({},e)).port&&(r.port=443),r.secureEndpoint=!0,i.call(o,r,t)}),o.get=function(e,t){const r=o.request(e,t);return r.end(),r}},function(e,t,r){"use strict";e.exports=function(){var e=r(145);return function(t,r){return function(){for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];var s=r&&r.multiArgs,a=void 0;return r&&r.thisArg?a=r.thisArg:r&&(a=r),new e(function(e,r){o.push(function(t){if(t)return r(t);for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];if(!1==!!s)return e(o[0]);e(o)});var n,i=t.apply(a,o);(n=i)&&"function"==typeof n.then&&"function"==typeof n.catch&&e(i)})}}}()},function(e,t,r){"use strict";e.exports=function(){var e=void 0;return e=void 0!==global?global:void 0!==window&&window.document?window:self,function(){if(!e.hasOwnProperty("Promise"))return!1;var t,r=e.Promise;return!(!r.hasOwnProperty("resolve")||!r.hasOwnProperty("reject"))&&(!(!r.hasOwnProperty("all")||!r.hasOwnProperty("race"))&&(t=void 0,!!new e.Promise(function(e){t=e})&&"function"==typeof t))}()?e.Promise:r(146).Promise}()},function(e,t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.6+9869a4bc
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,o=void 0,i=function(e,t){h[r]=e,h[r+1]=t,2===(r+=2)&&(o?o(f):m())},s="undefined"!=typeof window?window:void 0,a=s||{},c=a.MutationObserver||a.WebKitMutationObserver,u="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function l(){var e=setTimeout;return function(){return e(f,1)}}var h=new Array(1e3);function f(){for(var e=0;e<r;e+=2){(0,h[e])(h[e+1]),h[e]=void 0,h[e+1]=void 0}r=0}var d,g,y,v,m=void 0;function _(e,t){var r=this,n=new this.constructor(S);void 0===n[w]&&L(n);var o=r._state;if(o){var s=arguments[o-1];i(function(){return F(o,n,s,r._result)})}else D(r,n,e,t);return n}function b(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(S);return P(t,e),t}u?m=function(){return process.nextTick(f)}:c?(g=0,y=new c(f),v=document.createTextNode(""),y.observe(v,{characterData:!0}),m=function(){v.data=g=++g%2}):p?((d=new MessageChannel).port1.onmessage=f,m=function(){return d.port2.postMessage(0)}):m=void 0===s?function(){try{var e=Function("return this")().require("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(f)}:l()}catch(e){return l()}}():l();var w=Math.random().toString(36).substring(2);function S(){}var E=void 0,C=1,x=2,O={error:null};function k(e){try{return e.then}catch(e){return O.error=e,O}}function T(t,r,n){r.constructor===t.constructor&&n===_&&r.constructor.resolve===b?function(e,t){t._state===C?A(e,t._result):t._state===x?j(e,t._result):D(t,void 0,function(t){return P(e,t)},function(t){return j(e,t)})}(t,r):n===O?(j(t,O.error),O.error=null):void 0===n?A(t,r):e(n)?function(e,t,r){i(function(e){var n=!1,o=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,function(r){n||(n=!0,t!==r?P(e,r):A(e,r))},function(t){n||(n=!0,j(e,t))},e._label);!n&&o&&(n=!0,j(e,o))},e)}(t,r,n):A(t,r)}function P(e,t){var r,n;e===t?j(e,new TypeError("You cannot resolve a promise with itself")):(n=typeof(r=t),null===r||"object"!==n&&"function"!==n?A(e,t):T(e,t,k(t)))}function M(e){e._onerror&&e._onerror(e._result),N(e)}function A(e,t){e._state===E&&(e._result=t,e._state=C,0!==e._subscribers.length&&i(N,e))}function j(e,t){e._state===E&&(e._state=x,e._result=t,i(M,e))}function D(e,t,r,n){var o=e._subscribers,s=o.length;e._onerror=null,o[s]=t,o[s+C]=r,o[s+x]=n,0===s&&e._state&&i(N,e)}function N(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,o=void 0,i=e._result,s=0;s<t.length;s+=3)n=t[s],o=t[s+r],n?F(r,n,o,i):o(i);e._subscribers.length=0}}function F(t,r,n,o){var i=e(n),s=void 0,a=void 0,c=void 0,u=void 0;if(i){if((s=function(e,t){try{return e(t)}catch(e){return O.error=e,O}}(n,o))===O?(u=!0,a=s.error,s.error=null):c=!0,r===s)return void j(r,new TypeError("A promises callback cannot return that same promise."))}else s=o,c=!0;r._state!==E||(i&&c?P(r,s):u?j(r,a):t===C?A(r,s):t===x&&j(r,s))}var R=0;function L(e){e[w]=R++,e._state=void 0,e._result=void 0,e._subscribers=[]}var B=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(S),this.promise[w]||L(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&A(this.promise,this._result))):j(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===E&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===b){var o=k(e);if(o===_&&e._state!==E)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(r===I){var i=new r(S);T(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new r(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===E&&(this._remaining--,e===x?j(n,r):this._result[t]=r),0===this._remaining&&A(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;D(e,void 0,function(e){return r._settledAt(C,t,e)},function(e){return r._settledAt(x,t,e)})},e}(),I=function(){function t(e){this[w]=R++,this._result=this._state=void 0,this._subscribers=[],S!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t(function(t){P(e,t)},function(t){j(e,t)})}catch(t){j(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})}):this.then(t,t)},t}();return I.prototype.then=_,I.all=function(e){return new B(this,e).promise},I.race=function(e){var r=this;return t(e)?new r(function(t,n){for(var o=e.length,i=0;i<o;i++)r.resolve(e[i]).then(t,n)}):new r(function(e,t){return t(new TypeError("You must pass an array to race."))})},I.resolve=b,I.reject=function(e){var t=new this(S);return j(t,e),t},I._setScheduler=function(e){o=e},I._setAsap=function(e){i=e},I._asap=i,I.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=I},I.Promise=I,I},e.exports=n()},function(e,t){e.exports=require("events")},function(e,t,r){"use strict";"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(149):e.exports=r(151)},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":n(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(n++,"%c"===e&&(o=n))}),t.splice(o,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=r(59)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},function(e,t){var r=1e3,n=60*r,o=60*n,i=24*o,s=7*i,a=365.25*i;function c(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}e.exports=function(e,t){t=t||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var c=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*a;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*o;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&!1===isNaN(e))return t.long?function(e){var t=Math.abs(e);if(t>=i)return c(e,t,i,"day");if(t>=o)return c(e,t,o,"hour");if(t>=n)return c(e,t,n,"minute");if(t>=r)return c(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=o)return Math.round(e/o)+"h";if(t>=n)return Math.round(e/n)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){"use strict";var n=r(60),o=r(20);t.init=function(e){e.inspectOpts={};for(var r=Object.keys(t.inspectOpts),n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(){return process.stderr.write(o.format.apply(o,arguments)+"\n")},t.formatArgs=function(r){var n=this.namespace;if(this.useColors){var o=this.color,i="[3"+(o<8?o:"8;5;"+o),s="  ".concat(i,";1m").concat(n," [0m");r[0]=s+r[0].split("\n").join("\n"+s),r.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{var i=r(61);i&&(i.stderr||i).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(e,t){return t.toUpperCase()}),n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e},{}),e.exports=r(59)(t);var s=e.exports.formatters;s.o=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts).replace(/\s*\n\s*/g," ")},s.O=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts)}},function(e,t,r){"use strict";e.exports=((e,t)=>{t=t||process.argv;const r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),o=t.indexOf("--");return-1!==n&&(-1===o||n<o)})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=r(41),s=r(58),a=function(e){function t(t){var r=e.call(this,t)||this;r.options=t,r.module=i;var n=t.httpsProxy||t.httpProxy||process.env.https_proxy||process.env.http_proxy;return r.client=n?new s(n):new i.Agent({keepAlive:!1,maxSockets:30,timeout:2e3}),r}return n.__extends(t,e),t.prototype.sendEvent=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){if(!this.module)throw new o.SentryError("No module available in HTTPSTransport");return[2,this.sendWithModule(this.module,e)]})})},t}(r(38).BaseTransport);t.HTTPSTransport=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=r(9),s=r(64),a=r(63),c=r(65);t.defaultIntegrations=[new o.Integrations.Dedupe,new o.Integrations.InboundFilters,new o.Integrations.FunctionToString,new o.Integrations.ExtraErrorData,new c.Console,new c.Http,new c.OnUncaughtException,new c.OnUnhandledRejection,new c.LinkedErrors],t.init=function(e){void 0===e&&(e={}),void 0===e.defaultIntegrations&&(e.defaultIntegrations=t.defaultIntegrations),void 0===e.dsn&&process.env.SENTRY_DSN&&(e.dsn=process.env.SENTRY_DSN),s.active&&i.setHubOnCarrier(i.getMainCarrier(),o.getCurrentHub()),o.initAndBind(a.NodeClient,e)},t.lastEventId=function(){return o.getCurrentHub().lastEventId()},t.flush=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,o.getCurrentHub().getClient().flush(e)]})})},t.close=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,o.getCurrentHub().getClient().close(e)]})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=r(17),s=r(10),a=r(20),c=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){var t=r(66);s.fill(t,"_load",function(t){return function(r){return function(c){var u=r.apply(t,arguments);return"console"!==c||u.__sentry__?u:(["debug","info","warn","error","log"].forEach(function(t){return function(r){r in t&&s.fill(t,r,function(s){var c;switch(r){case"debug":c=i.Severity.Debug;break;case"error":c=i.Severity.Error;break;case"info":c=i.Severity.Info;break;case"warn":c=i.Severity.Warning;break;default:c=i.Severity.Log}return function(){o.getCurrentHub().getIntegration(e)&&o.getCurrentHub().addBreadcrumb({category:"console",level:c,message:a.format.apply(void 0,arguments)},{input:n.__spread(arguments),level:r}),s.apply(t,arguments)}})}}(u)),u.__sentry__=!0,u)}}}(t)),r(156)},e.id="Console",e}();t.Console=c},function(e,t){e.exports=require("console")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(2),i=r(10),s=r(20),a=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){var e=r(66);i.fill(e,"_load",function(e){return function(t){return function(r){var n=t.apply(e,arguments);if("http"!==r||n.__sentry__)return n;var o=n.ClientRequest,a=function(e,t){o.call(this,e,t),this.__ravenBreadcrumbUrl=function(e){if("string"==typeof e)return e;var t=e.protocol||"",r=e.hostname||e.host||"",n=e.port&&80!==e.port&&443!==e.port?":"+e.port:"",o=e.path||"/";return t+"//"+r+n+o}(e)};return s.inherits(a,o),i.fill(a.prototype,"emit",c),i.fill(n,"ClientRequest",function(){return a}),i.fill(n,"request",function(){return function(e,t){return new n.ClientRequest(e,t)}}),i.fill(n,"get",function(){return function(e,t){var r=n.request(e,t);return r.end(),r}}),n.__sentry__=!0,n}}}(e)),r(40)},e.id="Http",e}();function c(e){return function(t,r){if(void 0!==n&&n===r)return e.apply(this,arguments);n=r;var i=o.getCurrentHub().getClient().getDsn(),s="response"===t||"error"===t,c=i&&this.__ravenBreadcrumbUrl&&!this.__ravenBreadcrumbUrl.includes(i.host);return s&&c&&o.getCurrentHub().getIntegration(a)&&o.getCurrentHub().addBreadcrumb({category:"http",data:{method:this.method,status_code:r.statusCode,url:this.__ravenBreadcrumbUrl},type:"http"},{event:t,request:this,response:r}),e.apply(this,arguments)}}t.Http=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=r(17),s=r(7),a=r(67),c=function(){function e(t){void 0===t&&(t={}),this.options=t,this.name=e.id,this.handler=u(this.options.onFatalError)}return e.prototype.setupOnce=function(){global.process.on("uncaughtException",this.handler.bind(this))},e.id="OnUncaughtException",e}();function u(e){var t=this;void 0===e&&(e=a.defaultOnFatalError);var r,u=!1,p=!1,l=!1;return function(h){if(u)l?(s.logger.warn("uncaught exception after calling fatal error shutdown callback - this is bad! forcing shutdown"),a.defaultOnFatalError(h)):p||(p=!0,setTimeout(function(){l||(l=!0,e(r,h))},2e3));else{var f=o.getCurrentHub();r=h,u=!0,f.getIntegration(c)?f.withScope(function(r){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return r.setLevel(i.Severity.Fatal),f.captureException(h,{originalException:h}),l||(l=!0,e(h)),[2]})})}):l||(l=!0,e(h))}}}t.OnUncaughtException=c,t.makeErrorHandler=u},function(e,t,r){"use strict";
/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */t.parse=function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var r={},o=t||{},s=e.split(i),c=o.decode||n,u=0;u<s.length;u++){var p=s[u],l=p.indexOf("=");if(!(l<0)){var h=p.substr(0,l).trim(),f=p.substr(++l,p.length).trim();'"'==f[0]&&(f=f.slice(1,-1)),null==r[h]&&(r[h]=a(f,c))}}return r},t.serialize=function(e,t,r){var n=r||{},i=n.encode||o;if("function"!=typeof i)throw new TypeError("option encode is invalid");if(!s.test(e))throw new TypeError("argument name is invalid");var a=i(t);if(a&&!s.test(a))throw new TypeError("argument val is invalid");var c=e+"="+a;if(null!=n.maxAge){var u=n.maxAge-0;if(isNaN(u))throw new Error("maxAge should be a Number");c+="; Max-Age="+Math.floor(u)}if(n.domain){if(!s.test(n.domain))throw new TypeError("option domain is invalid");c+="; Domain="+n.domain}if(n.path){if(!s.test(n.path))throw new TypeError("option path is invalid");c+="; Path="+n.path}if(n.expires){if("function"!=typeof n.expires.toUTCString)throw new TypeError("option expires is invalid");c+="; Expires="+n.expires.toUTCString()}n.httpOnly&&(c+="; HttpOnly");n.secure&&(c+="; Secure");if(n.sameSite){var p="string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite;switch(p){case!0:c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"strict":c+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return c};var n=decodeURIComponent,o=encodeURIComponent,i=/; */,s=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function a(e,t){try{return t(e)}catch(t){return e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){global.process.on("unhandledRejection",this.sendUnhandledPromise.bind(this))},e.prototype.sendUnhandledPromise=function(t,r){var o=n.getCurrentHub();if(o.getIntegration(e)){var i=r.domain&&r.domain.sentryContext||{};o.withScope(function(e){e.setExtra("unhandledPromiseRejection",!0),i.user&&e.setUser(i.user),i.tags&&Object.keys(i.tags).forEach(function(t){e.setTag(t,i.tags[t])}),i.extra&&Object.keys(i.extra).forEach(function(t){e.setExtra(t,i.extra[t])}),o.captureException(t,{originalException:r})})}},e.id="OnUnhandledRejection",e}();t.OnUnhandledRejection=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=r(37),s="cause",a=5,c=function(){function e(t){void 0===t&&(t={}),this.name=e.id,this.key=t.key||s,this.limit=t.limit||a}return e.prototype.setupOnce=function(){var t=this;o.addGlobalEventProcessor(function(r,i){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){return(t=o.getCurrentHub().getIntegration(e))?[2,t.handler(r,i)]:[2,r]})})})},e.prototype.handler=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(o){switch(o.label){case 0:return e.exception&&e.exception.values&&t&&t.originalException instanceof Error?[4,this.walkErrorTree(t.originalException,this.key)]:[2,e];case 1:return r=o.sent(),e.exception.values=n.__spread(r,e.exception.values),[2,e]}})})},e.prototype.walkErrorTree=function(e,t,r){return void 0===r&&(r=[]),n.__awaiter(this,void 0,void 0,function(){var o;return n.__generator(this,function(s){switch(s.label){case 0:return!(e[t]instanceof Error)||r.length+1>=this.limit?[2,r]:[4,i.getExceptionFromError(e[t])];case 1:return o=s.sent(),[2,this.walkErrorTree(e[t],t,n.__spread([o],r))]}})})},e.id="LinkedErrors",e}();t.LinkedErrors=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(0),i=r(2),s=r(163),a=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){var t=this;i.addGlobalEventProcessor(function(r){return o.__awaiter(t,void 0,void 0,function(){return o.__generator(this,function(t){return i.getCurrentHub().getIntegration(e)?[2,o.__assign({},r,{modules:this.getModules()})]:[2,r]})})})},e.prototype.getModules=function(){return n||(n=s()),n},e.id="Modules",e}();t.Modules=a},function(e,t,r){var n=r(30),o=r(56);n.existsSync=n.existsSync||o.existsSync;var i=r.c[r.s]&&r.c[r.s].paths||[];e.exports=function(){var e=Object.keys(r.c||[]),t={},s={};return e.forEach(function(e){var r=e;!function e(){var a=r;if((r=o.dirname(a))&&a!==r&&!s[a]){if(i.indexOf(r)<0)return e();var c=o.join(a,"package.json"),u=n.existsSync(c);if(s[a]=!0,!u)return e();try{var p=JSON.parse(n.readFileSync(c,"utf8"));t[p.name]=p.version}catch(e){}}}()}),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(2),i=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){var t=this;o.addGlobalEventProcessor(function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){return(t=o.getCurrentHub().getIntegration(e))?[2,t.process(r)]:[2,r]})})})},e.prototype.process=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,o;return n.__generator(this,function(n){for(t=this.getFramesFromEvent(e),r=t.length-1;r>=0;r--)if(!0===(o=t[r]).in_app){e.transaction=this.getTransaction(o);break}return[2,e]})})},e.prototype.getFramesFromEvent=function(e){var t=e.exception&&e.exception.values&&e.exception.values[0];return t&&t.stacktrace&&t.stacktrace.frames||[]},e.prototype.getTransaction=function(e){return e.module||e.function?(e.module||"?")+"/"+(e.function||"?"):"<unknown>"},e.id="Transaction",e}();t.Transaction=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(36),o=r(166),i=r(23);t.ConsoleReLogger=class{constructor(e){this.channel=e,this.cleanup=!1,this.buffer=new n.PromiseBuffer(30),this.socket=o.connect("https://console.re:443",{transports:["websocket"]}),this.socket.on("connect",()=>{i.LogService.transportLog.information("ConsoleRe connected")}),this.socket.on("connect_error",e=>{i.LogService.transportLog.error(e,"ConsoleRe socket connect_error")}),this.socket.on("reconnect_error",e=>{i.LogService.transportLog.error(e,"ConsoleRe socket reconnect_error")}),this.socket.on("error",e=>{i.LogService.transportLog.error(e,"ConsoleRe socket error")}),this.socket.on("disconnect",()=>{i.LogService.transportLog.information("ConsoleRe disconnected"),this.cleanup||this.socket.connect()})}teardown(){return this.buffer.drain().then(()=>(this.cleanup=!0,this.socket.disconnect(),delete this.socket,delete this.buffer,i.LogService.transportLog.information("ConsoleRe cleaned up"),!0))}information(e,t,...r){this.sendLog("info",`${e} ${t}`,...r)}debug(e,t,...r){this.sendLog("debug",`${e} ${t}`,...r)}error(e,...t){this.sendLog("error",...t,e)}sendLog(e,...t){this.buffer.add(new Promise(r=>{this.socket.connected&&this.socket.emit("toServerRe",{channel:this.channel,level:e,args:t,caller:{file:"ConsoleReLogger.ts",line:75,column:9},browser:{browser:{f:"homey-heating",s:"H"},version:"1.2.1-alpha",OS:"Homey"}}),r()})).catch(e=>{i.LogService.transportLog.error(e,"ConsoleRe could not send log: ",...t,e)})}}},function(e,t,r){var n=r(167),o=r(42),i=r(72),s=r(11)("socket.io-client");e.exports=t=c;var a=t.managers={};function c(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var r,o=n(e),c=o.source,u=o.id,p=o.path,l=a[u]&&p in a[u].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||l?(s("ignoring socket cache for %s",c),r=i(c,t)):(a[u]||(s("new io instance for %s",c),a[u]=i(c,t)),r=a[u]),o.query&&!t.query&&(t.query=o.query),r.socket(o.path,t)}t.protocol=o.protocol,t.connect=c,t.Manager=r(72),t.Socket=r(78)},function(e,t,r){var n=r(68),o=r(11)("socket.io-client:url");e.exports=function(e,t){var r=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host);"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),r=n(e));r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443"));r.path=r.path||"/";var i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port,r.href=r.protocol+"://"+i+(t&&t.port===r.port?"":":"+r.port),r}},function(e,t,r){function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=r(69)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())},function(e,t){var r=1e3,n=60*r,o=60*n,i=24*o,s=365.25*i;function a(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,t){t=t||{};var c,u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*s;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*o;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===u&&!1===isNaN(e))return t.long?a(c=e,i,"day")||a(c,o,"hour")||a(c,n,"minute")||a(c,r,"second")||c+" ms":function(e){if(e>=i)return Math.round(e/i)+"d";if(e>=o)return Math.round(e/o)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){var n=r(60),o=r(20);(t=e.exports=r(69)).init=function(e){e.inspectOpts={};for(var r=Object.keys(t.inspectOpts),n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(){return process.stderr.write(o.format.apply(o,arguments)+"\n")},t.formatArgs=function(e){var r=this.namespace;if(this.useColors){var n=this.color,o="[3"+(n<8?n:"8;5;"+n),i="  "+o+";1m"+r+" [0m";e[0]=i+e[0].split("\n").join("\n"+i),e.push(o+"m+"+t.humanize(this.diff)+"[0m")}else e[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+r+" "+e[0]},t.save=function(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},t.load=s,t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{var i=r(61);i&&i.level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}function s(){return process.env.DEBUG}t.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(e,t){return t.toUpperCase()}),n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e},{}),t.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts).split("\n").map(function(e){return e.trim()}).join(" ")},t.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts)},t.enable(s())},function(e,t,r){var n=r(70),o=r(71),i=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);t.deconstructPacket=function(e){var t=[],r=e.data,i=e;return i.data=function e(t,r){if(!t)return t;if(o(t)){var i={_placeholder:!0,num:r.length};return r.push(t),i}if(n(t)){for(var s=new Array(t.length),a=0;a<t.length;a++)s[a]=e(t[a],r);return s}if("object"==typeof t&&!(t instanceof Date)){var s={};for(var c in t)s[c]=e(t[c],r);return s}return t}(r,t),i.attachments=t.length,{packet:i,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,r){if(!t)return t;if(t&&t._placeholder)return r[t.num];if(n(t))for(var o=0;o<t.length;o++)t[o]=e(t[o],r);else if("object"==typeof t)for(var i in t)t[i]=e(t[i],r);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var r=0,i=e;!function e(c,u,p){if(!c)return c;if(s&&c instanceof Blob||a&&c instanceof File){r++;var l=new FileReader;l.onload=function(){p?p[u]=this.result:i=this.result,--r||t(i)},l.readAsArrayBuffer(c)}else if(n(c))for(var h=0;h<c.length;h++)e(c[h],h,c);else if("object"==typeof c&&!o(c))for(var f in c)e(c[f],f,c)}(i),r||t(i)}},function(e,t,r){e.exports=r(173),e.exports.parser=r(22)},function(e,t,r){var n=r(73),o=r(21),i=r(11)("engine.io-client:socket"),s=r(77),a=r(22),c=r(68),u=r(32);function p(e,t){if(!(this instanceof p))return new p(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=c(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=c(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=p,p.priorWebsocketSuccess=!1,o(p.prototype),p.protocol=a.protocol,p.Socket=p,p.Transport=r(44),p.transports=r(73),p.parser=r(22),p.prototype.createTransport=function(e){i('creating transport "%s"',e);var t=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}(this.query);t.EIO=a.protocol,t.transport=e;var r=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new n[e]({query:t,socket:this,agent:r.agent||this.agent,hostname:r.hostname||this.hostname,port:r.port||this.port,secure:r.secure||this.secure,path:r.path||this.path,forceJSONP:r.forceJSONP||this.forceJSONP,jsonp:r.jsonp||this.jsonp,forceBase64:r.forceBase64||this.forceBase64,enablesXDR:r.enablesXDR||this.enablesXDR,timestampRequests:r.timestampRequests||this.timestampRequests,timestampParam:r.timestampParam||this.timestampParam,policyPort:r.policyPort||this.policyPort,pfx:r.pfx||this.pfx,key:r.key||this.key,passphrase:r.passphrase||this.passphrase,cert:r.cert||this.cert,ca:r.ca||this.ca,ciphers:r.ciphers||this.ciphers,rejectUnauthorized:r.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||this.perMessageDeflate,extraHeaders:r.extraHeaders||this.extraHeaders,forceNode:r.forceNode||this.forceNode,localAddress:r.localAddress||this.localAddress,requestTimeout:r.requestTimeout||this.requestTimeout,protocols:r.protocols||void 0,isReactNative:this.isReactNative})},p.prototype.open=function(){var e;if(this.rememberUpgrade&&p.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},p.prototype.setTransport=function(e){i("setting transport %s",e.name);var t=this;this.transport&&(i("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},p.prototype.probe=function(e){i('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),r=!1,n=this;function o(){if(n.onlyBinaryUpgrades){var o=!this.supportsBinary&&n.transport.supportsBinary;r=r||o}r||(i('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(o){if(!r)if("pong"===o.type&&"probe"===o.data){if(i('probe transport "%s" pong',e),n.upgrading=!0,n.emit("upgrading",t),!t)return;p.priorWebsocketSuccess="websocket"===t.name,i('pausing current transport "%s"',n.transport.name),n.transport.pause(function(){r||"closed"!==n.readyState&&(i("changing transport and sending upgrade packet"),h(),n.setTransport(t),t.send([{type:"upgrade"}]),n.emit("upgrade",t),t=null,n.upgrading=!1,n.flush())})}else{i('probe transport "%s" failed',e);var s=new Error("probe error");s.transport=t.name,n.emit("upgradeError",s)}}))}function s(){r||(r=!0,h(),t.close(),t=null)}function a(r){var o=new Error("probe error: "+r);o.transport=t.name,s(),i('probe transport "%s" failed because of error: %s',e,r),n.emit("upgradeError",o)}function c(){a("transport closed")}function u(){a("socket closed")}function l(e){t&&e.name!==t.name&&(i('"%s" works - aborting "%s"',e.name,t.name),s())}function h(){t.removeListener("open",o),t.removeListener("error",a),t.removeListener("close",c),n.removeListener("close",u),n.removeListener("upgrading",l)}p.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",a),t.once("close",c),this.once("close",u),this.once("upgrading",l),t.open()},p.prototype.onOpen=function(){if(i("socket open"),this.readyState="open",p.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){i("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},p.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(i('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else i('packet received with socket readyState "%s"',this.readyState)},p.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},p.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},p.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){i("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},p.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},p.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},p.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(i("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},p.prototype.write=p.prototype.send=function(e,t,r){return this.sendPacket("message",e,t,r),this},p.prototype.sendPacket=function(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var o={type:e,data:t,options:r};this.emit("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush()}},p.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():t()}):this.upgrading?n():t()}function t(){e.onClose("forced close"),i("socket closing - telling transport to close"),e.transport.close()}function r(){e.removeListener("upgrade",r),e.removeListener("upgradeError",r),t()}function n(){e.once("upgrade",r),e.once("upgradeError",r)}return this},p.prototype.onError=function(e){i("socket error %j",e),p.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},p.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){i('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},p.prototype.filterUpgrades=function(e){for(var t=[],r=0,n=e.length;r<n;r++)~s(this.transports,e[r])&&t.push(e[r]);return t}},function(e,t){e.exports=require("child_process")},function(e,t,r){var n=r(43),o=r(74),i=r(21),s=r(33),a=r(11)("engine.io-client:polling-xhr");function c(){}function u(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,r=location.port;r||(r=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port,this.xs=e.secure!==t}}function p(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=u,e.exports.Request=p,s(u,o),u.prototype.supportsBinary=!0,u.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new p(e)},u.prototype.doWrite=function(e,t){var r="string"!=typeof e&&void 0!==e,n=this.request({method:"POST",data:e,isBinary:r}),o=this;n.on("success",t),n.on("error",function(e){o.onError("xhr post error",e)}),this.sendXhr=n},u.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},i(p.prototype),p.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new n(e),r=this;try{a("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){r.onLoad()},t.onerror=function(){r.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");r.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?r.onLoad():setTimeout(function(){r.onError(t.status)},0))},a("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){r.onError(e)},0)}"undefined"!=typeof document&&(this.index=p.requestsCount++,p.requests[this.index]=this)},p.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},p.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},p.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},p.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete p.requests[this.index],this.xhr=null}},p.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},p.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},p.prototype.abort=function(){this.cleanup()},p.requestsCount=0,p.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",h);else if("function"==typeof addEventListener){var l="onpagehide"in self?"pagehide":"unload";addEventListener(l,h,!1)}function h(){for(var e in p.requests)p.requests.hasOwnProperty(e)&&p.requests[e].abort()}},function(e,t){
/*! https://mths.be/utf8js v2.1.2 by @mathias */
var r,n,o,i=String.fromCharCode;function s(e){for(var t,r,n=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function a(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function c(e,t){return i(e>>t&63|128)}function u(e,t){if(0==(4294967168&e))return i(e);var r="";return 0==(4294965248&e)?r=i(e>>6&31|192):0==(4294901760&e)?(a(e,t)||(e=65533),r=i(e>>12&15|224),r+=c(e,6)):0==(4292870144&e)&&(r=i(e>>18&7|240),r+=c(e,12),r+=c(e,6)),r+=i(63&e|128)}function p(){if(o>=n)throw Error("Invalid byte index");var e=255&r[o];if(o++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function l(e){var t,i;if(o>n)throw Error("Invalid byte index");if(o==n)return!1;if(t=255&r[o],o++,0==(128&t))return t;if(192==(224&t)){if((i=(31&t)<<6|p())>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&t)){if((i=(15&t)<<12|p()<<6|p())>=2048)return a(i,e)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(i=(7&t)<<18|p()<<12|p()<<6|p())>=65536&&i<=1114111)return i;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var r=!1!==(t=t||{}).strict,n=s(e),o=n.length,i=-1,a="";++i<o;)a+=u(n[i],r);return a},decode:function(e,t){var a=!1!==(t=t||{}).strict;r=s(e),n=r.length,o=0;for(var c,u=[];!1!==(c=l(a));)u.push(c);return function(e){for(var t,r=e.length,n=-1,o="";++n<r;)(t=e[n])>65535&&(o+=i((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=i(t);return o}(u)}}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t){function r(){}e.exports=function(e,t,n){var o=!1;return n=n||r,i.count=e,0===e?t():i;function i(e,r){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,t(e),t=n):0!==i.count||o||t(null,r)}}},function(e,t){e.exports=Object.keys||function(e){var t=[],r=Object.prototype.hasOwnProperty;for(var n in e)r.call(e,n)&&t.push(n);return t}},function(e,t,r){var n=r(74),o=r(33);e.exports=p;var i,s=/\n/g,a=/\\n/g;function c(){}function u(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}}function p(e){if(n.call(this,e),this.query=this.query||{},!i){var t=u();i=t.___eio=t.___eio||[]}this.index=i.length;var r=this;i.push(function(e){r.onData(e)}),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){r.script&&(r.script.onerror=c)},!1)}o(p,n),p.prototype.supportsBinary=!1,p.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),n.prototype.doClose.call(this)},p.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(t,r):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},p.prototype.doWrite=function(e,t){var r=this;if(!this.form){var n,o=document.createElement("form"),i=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),i.name="d",o.appendChild(i),document.body.appendChild(o),this.form=o,this.area=i}function u(){p(),t()}function p(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(e){r.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+r.iframeId+'">';n=document.createElement(e)}catch(e){(n=document.createElement("iframe")).name=r.iframeId,n.src="javascript:0"}n.id=r.iframeId,r.form.appendChild(n),r.iframe=n}this.form.action=this.uri(),p(),e=e.replace(a,"\\\n"),this.area.value=e.replace(s,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&u()}:this.iframe.onload=u}},function(e,t,r){var n,o,i=r(44),s=r(22),a=r(32),c=r(33),u=r(76),p=r(11)("engine.io-client:websocket");if("undefined"!=typeof WebSocket)n=WebSocket;else if("undefined"!=typeof self)n=self.WebSocket||self.MozWebSocket;else try{o=r(182)}catch(e){}var l=n||o;function h(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=n&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(l=o),i.call(this,e)}e.exports=h,c(h,i),h.prototype.name="websocket",h.prototype.supportsBinary=!0,h.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new l(e,t):new l(e):new l(e,t,r)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},h.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},h.prototype.write=function(e){var t=this;this.writable=!1;for(var r=e.length,n=0,o=r;n<o;n++)!function(e){s.encodePacket(e,t.supportsBinary,function(n){if(!t.usingBrowserWebSocket){var o={};if(e.options&&(o.compress=e.options.compress),t.perMessageDeflate)("string"==typeof n?Buffer.byteLength(n):n.length)<t.perMessageDeflate.threshold&&(o.compress=!1)}try{t.usingBrowserWebSocket?t.ws.send(n):t.ws.send(n,o)}catch(e){p("websocket closed before onclose event")}--r||i()})}(e[n]);function i(){t.emit("flush"),setTimeout(function(){t.writable=!0,t.emit("drain")},0)}},h.prototype.onClose=function(){i.prototype.onClose.call(this)},h.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},h.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",r="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e},h.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===h.prototype.name)}},function(e,t){e.exports=require("ws")},function(e,t){e.exports=function(e,t){for(var r=[],n=(t=t||0)||0;n<e.length;n++)r[n-t]=e[n];return r}},function(e,t){function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=r,r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(23);let o=!0;function i(e,t,r,i,s){if(null!=this.logger?this.logger.error(s,`Calling ${e} failed due to ${s}`):n.LogService.default.error(s,`Calling ${e} failed due to ${s}`),t&&o)return i?Promise.resolve(r):r;if(i)return Promise.reject(s);throw s}function s(e,t,r,n){return function(...o){try{const a=t.apply(this,o);return null==(s=a)||"function"!=typeof s.then?a:a.catch(i.bind(this,e,r,n,!0))}catch(t){return i.call(this,e,r,n,!1,t)}var s}}t.setAllowCatchAll=function(e){o=e},t.trycatchlog=function(e=!1,t=null){return(r,n,o,...i)=>null!=o.value||void 0!==o.value?Object.assign({},o,{value:s.apply(this,[n,o.value,e,t])}):Object.assign({},o,{set:s.apply(this,[n,o.set,e,t]),get:s.apply(this,[n,o.get,e,t])})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(1),i=r(187),s=r(23);let a=class{createLogger(e){return new i.CategoryLogger(s.LogService.default,e)}};a=n.__decorate([o.singleton()],a),t.LoggerFactory=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e,t,r=!0){this.logger=e,this.category=r?`[${t.padEnd(10)}]`:t}createSubLogger(e){return new n(this.logger,`${this.category} [${e.padEnd(10)}]`,!1)}information(...e){this.logger.information(this.category,...e)}debug(...e){this.logger.debug(this.category,...e)}error(e,...t){this.logger.error(e,this.category,...t)}}t.CategoryLogger=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.TargetTemperature="target_temperature",e.MeasureTemperature="measure_temperature",e.ThermostatOverride="thermostat_override"}(t.CapabilityType||(t.CapabilityType={})),t.CLASS_THERMOSTAT="thermostat",t.TARGET_TEMPERATURE_MIN=4,t.TARGET_TEMPERATURE_MAX=35},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(82),i=r(1),s=r(6);let a=class{constructor(e){this.homeyAPI=null,this.logger=e.createLogger("APISvc")}getInstance(){return n.__awaiter(this,void 0,void 0,function*(){if(null==this.homeyAPI)try{this.logger.debug("Connecting to API"),this.homeyAPI=yield o.HomeyAPI.forCurrentHomey()}catch(e){throw this.logger.error(e,"CATASTROPHIC FAILURE **** CANNOT BE HANDELED *****"),this.homeyAPI=null,e}return this.homeyAPI})}};a=n.__decorate([i.singleton(),n.__metadata("design:paramtypes",[s.LoggerFactory])],a),t.HomeyAPIService=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(16),i=r(3),s=r(1),a=r(6);let c=class{constructor(e){this.logger=e.createLogger("Calculator")}getNextSchedule({schedule:e},t=new Date){if(this.logger.debug(`Searching next trigger for ${o.Day[t.getDay()]}@${t.getHours()}:${t.getMinutes()}`),null==e||0===e.length)return null;const r=i.sortBy(e,[e=>this.transposeDay(e.day),"hour","minute"]),n=this.findLastIndex(r,t);let s;s=n+1<r.length?r[n+1]:r[0],this.logger.debug(`> set point is ${o.Day[s.day]}@${s.hour}:${s.minute}`);const a=t;s.day===t.getDay()&&(s.hour<t.getHours()||s.hour===t.getHours()&&s.minute<=t.getMinutes())&&a.setDate(a.getDate()+7),a.setHours(s.hour,s.minute,0,0);let c=0;return c=s.day===t.getDay()?0:this.transposeDay(s.day)>this.transposeDay(t.getDay())?this.transposeDay(s.day)-this.transposeDay(t.getDay()):7-this.transposeDay(t.getDay())+this.transposeDay(s.day),a.setDate(t.getDate()+c),this.logger.debug(`> calculated date is ${a.toLocaleString()}`),a}getSetPoint({schedule:e},t=new Date){if(this.logger.debug(`Investigating ${o.Day[t.getDay()]}@${t.getHours()}:${t.getMinutes()}`),null==e||0===e.length)return null;const r=i.sortBy(e,[e=>this.transposeDay(e.day),"hour","minute"]);let n=this.findLastIndex(r,t);if(-1===n){this.logger.debug("> No trigger for today, looking at yesterday");const e=t;if(e.setDate(t.getDate()-1),e.setHours(23,59),-1===(n=this.findLastIndex(r,e)))return null}const s=r[n];return this.logger.debug(`> Target temperature is ${s.targetTemperature} (${o.Day[s.day]}@${s.hour}:${s.minute})`),s}findLastIndex(e,t){return i.findLastIndex(e,e=>{if(this.transposeDay(t.getDay())>this.transposeDay(e.day))return!0;if(this.transposeDay(t.getDay())===this.transposeDay(e.day)){if(t.getHours()>e.hour)return!0;if(t.getHours()===e.hour&&t.getMinutes()>=e.minute)return!0}return!1})}transposeDay(e){return e===o.Day.Sunday?7:e}};c=n.__decorate([s.injectable(),n.__metadata("design:paramtypes",[a.LoggerFactory])],c),t.HeatingPlanCalculator=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(8),i=r(16),s=r(5),a=r(3),c=r(1),u=r(45),p=r(46),l=r(47),h=r(26),f=r(6),d=r(12);let g=class{constructor(e,t,r,n,i,s){this.manager=e,this.calculator=t,this.repository=r,this.settings=n,this.flow=i,this.mutex=new o.Mutex,this.next=null,this.isRunning=!1,this.logger=s.createLogger("Scheduler"),this.repository.onChanged.subscribe(this.handleOnChanged.bind(this)),this.manager.onModeChanged.subscribe(this.handleOnChanged.bind(this))}get nextSchedule(){return this.next}stop(){return n.__awaiter(this,void 0,void 0,function*(){const e=yield this.mutex.lock();try{this.logger.information("Stop"),yield s.ManagerCron.unregisterAllTasks()}finally{e()}})}start(){return n.__awaiter(this,void 0,void 0,function*(){const e=yield this.mutex.lock();try{this.logger.information("Start"),yield this.registerTasks()}finally{e()}})}handleOnChanged(){return n.__awaiter(this,void 0,void 0,function*(){this.isRunning?this.logger.debug("Ignoring event, running"):yield this.start()})}applyPlans(e){return n.__awaiter(this,void 0,void 0,function*(){try{this.isRunning=!0,this.logger.createSubLogger("Plans").information("Running",e.map(e=>`${e.name} (${e.id})`)),yield Promise.all(e.map(e=>n.__awaiter(this,void 0,void 0,function*(){return yield this.manager.applyPlan(e)})))}finally{this.isRunning=!1,yield this.registerTasks()}})}clearOverrides(e){return n.__awaiter(this,void 0,void 0,function*(){try{this.isRunning=!0;const t=this.logger.createSubLogger("Overrides");t.information("Running");const r=yield this.repository.plans,o=[];r.forEach(e=>{e.thermostatMode===i.ThermostatMode.OverrideDay&&(t.information(`Reset thermostat mode of ${e.id}`),e.thermostatMode=i.NormalOperationMode.Automatic,o.push(e))}),0!==o.length&&(yield this.repository.update(o)),this.manager.operationMode===i.OverrideMode.DayAtHome||this.manager.operationMode===i.OverrideMode.DayAway||this.manager.operationMode===i.OverrideMode.Sleep?(t.information("Reverting to normal mode"),this.manager.operationMode=i.NormalOperationMode.Automatic,yield this.manager.applyPlans()):yield Promise.all(a.unionBy(e||[],o,e=>e.id).map(e=>n.__awaiter(this,void 0,void 0,function*(){yield this.manager.applyPlan(e)})))}finally{this.isRunning=!1,yield this.registerTasks()}})}registerTasks(){return n.__awaiter(this,void 0,void 0,function*(){yield s.ManagerCron.unregisterAllTasks();const e=new Date;e.setHours(0,0,0,0),e.setDate(e.getDate()+1);let t=[];if(this.manager.operationMode===i.OverrideMode.Holiday||this.manager.operationMode===i.OverrideMode.OutOfSeason)this.logger.information(`Mode is ${i.OverrideMode[this.manager.operationMode]}, no check required.`),this.next=null;else{const e=[],r=this.settings.get(d.InternalSettings.SchedulerTimeSlots,12);(yield this.repository.activePlans).forEach(t=>{this.logger.debug(`Checking plan ${t.id}`);const n=this.calculator.getNextSchedule(t);null!=n&&(n.setMinutes(o.slotTime(n.getMinutes(),r),0,0),e.push({date:n,plan:t}))});const n=a.map(a.groupBy(e,e=>e.date),(e,t)=>({date:new Date(t),plans:e.map(e=>e.plan)})),i=a.first(a.sortBy(n,e=>e.date));this.next=null!=i?i.date:null,null==this.next?this.logger.debug("No setpoint execution planned."):t=i.plans}let r="schedule";(null==this.next||this.next>=e)&&(this.next=e,r="cleanup"),this.next<=new Date(Date.now())&&(this.logger.error(new Error("Schedule is calculated wrong, earlier than today!"),new Date(Date.now()),yield this.repository.activePlans),this.next=new Date,this.next.setHours(this.next.getHours()+1),t=[]),this.logger.information(`Next execution is at ${this.next.toLocaleString()}`,t.map(e=>`${e.name} (${e.id})`));const n=yield s.ManagerCron.registerTask(r,this.next,t);null!=this.flow.nextDate&&this.flow.nextDate.setValue(this.next.toLocaleString()),this.next===e?n.once("run",this.clearOverrides.bind(this)):n.once("run",this.applyPlans.bind(this))})}};n.__decorate([f.trycatchlog(!0,null),n.__metadata("design:type",Object),n.__metadata("design:paramtypes",[])],g.prototype,"nextSchedule",null),n.__decorate([f.trycatchlog(!0),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[]),n.__metadata("design:returntype",Promise)],g.prototype,"stop",null),n.__decorate([f.trycatchlog(!0),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[]),n.__metadata("design:returntype",Promise)],g.prototype,"start",null),n.__decorate([f.trycatchlog(!0),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[]),n.__metadata("design:returntype",Promise)],g.prototype,"handleOnChanged",null),n.__decorate([f.trycatchlog(!0),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[Array]),n.__metadata("design:returntype",Promise)],g.prototype,"applyPlans",null),n.__decorate([f.trycatchlog(!0),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[Array]),n.__metadata("design:returntype",Promise)],g.prototype,"clearOverrides",null),g=n.__decorate([c.singleton(),n.__param(4,c.inject("FlowService")),n.__metadata("design:paramtypes",[l.HeatingManagerService,u.HeatingPlanCalculator,h.HeatingPlanRepositoryService,d.SettingsManagerService,p.FlowService,f.LoggerFactory])],g),t.HeatingSchedulerService=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);var o;const i=r(5),s=r(1),a=r(47),c=r(26),u=r(83),p=r(6),l=r(12),h=r(198),f=r(199),d=r(200),g=r(201),y=r(202),v=r(203),m=r(204),_=r(205);let b=o=class{constructor(e){this.loggerFactory=e,this.logger=this.loggerFactory.createLogger("Flows")}get nextDate(){return this.nextDateToken}get mode(){return this.modeToken}get modeChanged(){return this.modeChangedTrigger}get thermostatModeChanged(){return this.thermostatModeChangedTrigger}init(){return n.__awaiter(this,void 0,void 0,function*(){const e={logger:this.logger,manager:s.container.resolve(a.HeatingManagerService),repository:s.container.resolve(c.HeatingPlanRepositoryService),scheduler:s.container.resolve(u.HeatingSchedulerService),settings:s.container.resolve(l.SettingsManagerService)};[h.ApplyAllAction,f.ApplyPlanAction,g.SetLogStateAction,y.SetModeAction,v.SetPlanStateAction,m.SetThermostatOverrideAction].forEach(t=>{try{t(e)}catch(e){}}),this.modeChangedTrigger=d.ModeChangedTrigger(e),this.thermostatModeChangedTrigger=_.ThermostatModeChangedTrigger(e),this.logger.information("Registering token mode"),this.modeToken=new i.FlowToken("mode",{type:"string",title:i.__("plans.heatingmode.label")}),yield this.modeToken.register(),this.logger.information("Registering token next_schedule"),this.nextDateToken=new i.FlowToken("next_schedule",{type:"string",title:i.__("temperatures.next")}),yield this.nextDateToken.register()})}};n.__decorate([p.trycatchlog(!0),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[]),n.__metadata("design:returntype",Promise)],b.prototype,"init",null),b=o=n.__decorate([s.singleton(),s.registry([{token:"FlowService",useToken:o}]),n.__metadata("design:paramtypes",[p.LoggerFactory])],b),t.FlowService=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(3),i=r(34),s=r(1),a=r(81),c=r(6);function u(e){return null!=e.driverUri.match(/app\.mskg\.homey\-heating/gi)}function p(e){return null!=e.capabilities&&null!=e.capabilities.find(e=>e===a.CapabilityType.TargetTemperature)}function l(e){return null!=e.capabilities&&null!=e.capabilities.find(e=>e===a.CapabilityType.MeasureTemperature)}t.VirtualDevice=u,t.CanSetTargetTemperature=p,t.CanMeasureTemperature=l;let h=class{constructor(e,t){this.apiService=e,this.onCapabilityChangedDispatcher=new i.EventDispatcher,this.logger=t.createLogger("AthomAPI")}get zones(){return this.zoneList||{}}get devices(){return this.deviceList||{}}get onCapabilityChanged(){return this.onCapabilityChangedDispatcher.asEvent()}init(){return n.__awaiter(this,void 0,void 0,function*(){this.logger.information("Init"),this.homeyApi=yield this.apiService.getInstance();const e=o.filter(yield this.homeyApi.devices.getDevices(),e=>!u(e)&&p(e));this.logger.information(`Found ${e.length} devices`),this.deviceList={},yield Promise.all(e.map(e=>n.__awaiter(this,void 0,void 0,function*(){yield this.attachWatchers(e),this.deviceList[e.id]=e}))),this.zoneList=yield this.homeyApi.zones.getZones(),this.logger.information(`Found ${Object.keys(this.zoneList).length} zones`),this.homeyApi.devices.on("device.create",e=>n.__awaiter(this,void 0,void 0,function*(){if(u(e)||!p(e))return void this.logger.information(`Device ${e.id} was created but cannot set temperature -> ignored`);this.logger.debug(`Device ${e.id} was created.`);const t=yield this.homeyApi.devices.getDevice({id:e.id});this.deviceList[e.id]=t,yield this.attachWatchers(t)})),this.homeyApi.devices.on("device.update",e=>n.__awaiter(this,void 0,void 0,function*(){const t=this.deviceList[e.id];if(null!=t&&(yield this.destroyWatchers(t)),u(e)||!p(e))return this.logger.information(`Device ${e.id} was updated but cannot set temperature -> ignored`),void delete this.deviceList[e.id];this.logger.debug(`Device ${e.id} was updated.`);const r=yield this.homeyApi.devices.getDevice({id:e.id});this.deviceList[e.id]=r,yield this.attachWatchers(r)})),this.homeyApi.devices.on("device.delete",e=>n.__awaiter(this,void 0,void 0,function*(){this.logger.debug(`Device ${e.id} was removed.`),yield this.destroyWatchers(this.deviceList[e.id]),delete this.deviceList[e.id]})),this.homeyApi.zones.on("zone.create",e=>{this.logger.debug(`Zone ${e.id} was created.`),this.zoneList[e.id]=e}),this.homeyApi.zones.on("zone.update",e=>{this.logger.debug(`Zone ${e.id} was updated.`),this.zoneList[e.id]=e}),this.homeyApi.zones.on("zone.delete",e=>{this.logger.debug(`Zone ${e.id} was removed.`),delete this.zoneList[e.id]})})}findZone(e){return this.zoneList[e]}getTargetTemperature(e){const t=null!=e.watchedCapabilities?e.watchedCapabilities.targetTemperature:null;return null!=t?t.value:0}getMeasuredTemperature(e){const t=null!=e.watchedCapabilities?e.watchedCapabilities.temperature||e.watchedCapabilities.targetTemperature:null;return null!=t?t.value:0}setTargetTemperature(e,t){return n.__awaiter(this,void 0,void 0,function*(){let r=t;try{const n=null!=e.watchedCapabilities?e.watchedCapabilities.targetTemperature:null;null!=n&&(r>n.max?r=n.max:r<n.min?r=n.min:null!=n.step&&"number"==typeof n.step&&(r=0===n.step?Math.round(r):Math.round(r/n.step)*n.step),t!==r&&this.logger.information(`Target adjusted ${e.name} (${e.name}) was ${t} -> ${r} (min: ${n.min}, max: ${n.max}, step: ${n.step})`))}catch(e){this.logger.error(e,`Failed to adust temperature from ${t}`)}yield this.homeyApi.devices.setCapabilityValue({deviceId:e.id,capabilityId:a.CapabilityType.TargetTemperature,value:r})})}findDevice(e){return(this.deviceList||[])[e]}getDevicesForZone(e){return o.filter(this.deviceList||[],t=>t.zone===e)}attachWatchers(e){return n.__awaiter(this,void 0,void 0,function*(){null==e.watchedCapabilities&&(e.watchedCapabilities={}),null==e.watchedCapabilities.targetTemperature&&(this.logger.information(`Listening on ${e.id} (${e.name}) ${a.CapabilityType.TargetTemperature}`),e.watchedCapabilities.targetTemperature=yield e.makeCapabilityInstance(a.CapabilityType.TargetTemperature,t=>{this.logger.debug(`${e.name} (${e.id}) changed ${a.CapabilityType.TargetTemperature} to ${t}`),this.onCapabilityChangedDispatcher.dispatch(this,{capability:a.CapabilityType.TargetTemperature,device:e,value:t})})),null==e.watchedCapabilities.temperature&&l(e)&&(this.logger.information(`Listening on ${e.id} (${e.name}) ${a.CapabilityType.MeasureTemperature}`),e.watchedCapabilities.temperature=yield e.makeCapabilityInstance(a.CapabilityType.MeasureTemperature,t=>{this.logger.debug(`${e.name} (${e.id}) changed ${a.CapabilityType.MeasureTemperature} to ${t}`),this.onCapabilityChangedDispatcher.dispatch(this,{capability:a.CapabilityType.MeasureTemperature,device:e,value:t})}))})}destroyWatchers(e){return n.__awaiter(this,void 0,void 0,function*(){null!=e&&null!=e.watchedCapabilities&&(null!=e.watchedCapabilities.targetTemperature&&e.watchedCapabilities.targetTemperature.destroy(),null!=e.watchedCapabilities.temperature&&e.watchedCapabilities.temperature.destroy())})}};n.__decorate([c.trycatchlog(!0,0),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[Object]),n.__metadata("design:returntype",Number)],h.prototype,"getTargetTemperature",null),n.__decorate([c.trycatchlog(!0,0),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[Object]),n.__metadata("design:returntype",Number)],h.prototype,"getMeasuredTemperature",null),n.__decorate([c.trycatchlog(!0),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[Object]),n.__metadata("design:returntype",Promise)],h.prototype,"attachWatchers",null),n.__decorate([c.trycatchlog(!0),n.__metadata("design:type",Function),n.__metadata("design:paramtypes",[Object]),n.__metadata("design:returntype",Promise)],h.prototype,"destroyWatchers",null),h=n.__decorate([s.singleton(),n.__metadata("design:paramtypes",[a.HomeyAPIService,c.LoggerFactory])],h),t.DeviceManagerService=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);var o;const i=r(8),s=r(1),a=r(12),c=r(84),u=r(85),p=r(25);let l=o=class{constructor(e,t){const r=parseInt(t.get(a.InternalSettings.SetTemperatureThrottle,"2000"),10);this.setMethod=i.AsyncThrottle((t,r)=>n.__awaiter(this,void 0,void 0,function*(){return yield e.setTargetTemperature(t,r)}),r)}setTargetTemperature(e,t){return n.__awaiter(this,void 0,void 0,function*(){return yield this.setMethod(e,t)})}};l=o=n.__decorate([s.registry([{token:p.PolicyType.Throttled_Enforce,useFactory:e=>new o(e.resolve(u.EnforceTemperaturePolicy),e.resolve(a.SettingsManagerService))}]),s.registry([{token:p.PolicyType.Throttled_CheckTemperature,useFactory:e=>new o(e.resolve(c.CheckTemperaturePolicy),e.resolve(a.SettingsManagerService))}]),n.__metadata("design:paramtypes",[Object,a.SettingsManagerService])],l),t.ThrottledTemperaturePolicy=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(16),i=r(5),s=r(3),a=r(34),c=r(1),u=r(45),p=r(24),l=r(46),h=r(26),f=r(6),d=r(12),g=r(197),y=r(25);let v=class{constructor(e,t,r,s,u,p){this.plans=e,this.calc=t,this.deviceManager=r,this.settings=s,this.flow=u,this.onPlansAppliedDispatcher=new a.EventDispatcher,this.onModeDispatcher=new a.EventDispatcher,this.logger=p.createLogger("Manager"),this.isRunning=!1,this.mode=this.settings.get(d.InternalSettings.OperationMode,o.NormalOperationMode.Automatic),this.setTemperaturePolicy=c.container.resolve(this.settings.get(d.InternalSettings.SetTemperaturePolicy,y.PolicyType.Throttled_CheckTemperature)),this.planConflictPolicy=c.container.resolve(this.settings.get(d.InternalSettings.PlanConflictPolicy,g.TemperatureConflictPolicy.Max)),this.plans.onChanged.subscribe((e,t)=>n.__awaiter(this,void 0,void 0,function*(){try{yield Promise.all(t.map(e=>n.__awaiter(this,void 0,void 0,function*(){e.plan.enabled&&e.event!==h.PlanChangeEventType.Removed?yield this.applyPlan(e.plan):this.logger.debug(`Plan ${e.plan.name} (${e.plan.id}) is enabled/was removed - skipp`)})))}catch(e){this.logger.error(e,"Refresh of plans failed.")}})),this.onModeChanged.subscribe(()=>n.__awaiter(this,void 0,void 0,function*(){null!=this.flow.mode&&this.flow.mode.setValue(i.__(`Modes.${this.mode}`)),yield this.flow.modeChanged.trigger({mode:i.__(`Modes.${this.mode}`)}),this.settings.get(d.Settings.NotifyModeChange,!0)&&this.sendNotification("set_operation_mode",{mode:i.__(`Modes.${this.mode}`)}),yield this.applyPlans()}))}get onPlansApplied(){return this.onPlansAppliedDispatcher.asEvent()}get onModeChanged(){return this.onModeDispatcher.asEvent()}get operationMode(){return this.mode}set operationMode(e){this.logger.information("Setting mode to",e),this.mode=e,this.settings.set(d.InternalSettings.OperationMode,e),this.onModeDispatcher.dispatch(this,e)}init(){return n.__awaiter(this,void 0,void 0,function*(){null!=this.flow.mode&&this.flow.mode.setValue(i.__(`Modes.${this.mode}`)),yield this.applyPlans()})}applyPlans(){return n.__awaiter(this,void 0,void 0,function*(){if(!this.isRunning)try{this.isRunning=!0,this.logger.debug("Applying active plans");const e=yield this.evaluateActivePlans(),t=this.resolveConflicts(e);yield this.applySettings(t),this.onPlansAppliedDispatcher.dispatch(this,{plans:yield this.plans.activePlans,schedule:e})}finally{this.isRunning=!1}})}applyPlan(e){return n.__awaiter(this,void 0,void 0,function*(){const t=yield this.evaluatePlan(e);yield this.applySettings(t.map(e=>Object.assign({},e,{conflictingPlans:[e.plan]}))),this.onPlansAppliedDispatcher.dispatch(this,{plans:[e],schedule:t})})}evaluateActivePlans(){return n.__awaiter(this,void 0,void 0,function*(){const e=[];return s.forEach(yield this.plans.activePlans,t=>{e.push(...this.evaluatePlan(t))}),this.resolveConflicts(e)})}evaluatePlan(e){const t=this.logger.createSubLogger(e.id);t.debug("Evaluating");const r=this.expandPlan(e);if(null==r||0===r.length)return[];let n=0;const i=e.thermostatMode||o.NormalOperationMode.Automatic,s=e.overrides?e.overrides[this.mode]||e.overrides[o.OverrideMode[this.mode]]:null;if(null!=i&&i!==o.NormalOperationMode.Automatic)t.debug(`Thermostat overrides ${o.ThermostatMode[i]}`),n=this.deviceManager.getTargetTemperature(r[0]);else if(null!=s)t.debug(`Plan override for ${o.OverrideMode[this.mode]}`),n=s.targetTemperature;else{const r=this.calc.getSetPoint(e);if(null==r)return t.debug("Plan has not setpoints, done."),[];if("number"!=typeof(n=r.targetTemperature)&&(t.information("Setpoint has wrong datatype for temperature, trying to correct",r),n=parseFloat(n),isNaN(n)))return t.error(null,"Setpoint has wrong datatype for temperature",r),[]}return t.debug(`Calculated target temperature is ${n}`),r.map(t=>({device:{id:t.id,name:t.name},plan:{id:e.id,name:e.name},temperature:this.deviceManager.getMeasuredTemperature(t),targetTemperature:n,thermostatMode:i}))}setTemperature(e,t,r){return n.__awaiter(this,void 0,void 0,function*(){const n=yield this.setTemperaturePolicy.setTargetTemperature(t,r);n.success?n.skipped||this.settings.get(d.Settings.NotifySetSuccess,!0)&&this.sendNotification("set_target_temperature",{name:t.name,value:r,plan:e}):this.settings.get(d.Settings.NotifySetError,!0)&&this.sendNotification("failed_set_target_temperature",{name:t.name,value:r,error:n.error})})}resolveConflicts(e){return s.map(s.groupBy(e,e=>e.device.id),e=>{const t=this.planConflictPolicy.resolve(e);return{device:t.device,plan:t.plan,thermostatMode:t.thermostatMode,conflictingPlans:e.map(e=>e.plan),targetTemperature:t.targetTemperature,temperature:t.temperature}})}expandPlan(e){const t=this.logger.createSubLogger(e.id),r=[];return e.zones&&s.forEach(e.zones,e=>{const n=this.deviceManager.findZone(e);if(null==n)return void t.information(`Zone ${e} not found`);t.debug(`Looking at zone ${e}`);const o=this.deviceManager.getDevicesForZone(n.id);s.isEmpty(o)?t.debug("No devices found"):(t.debug(`Found ${o.length} device(s)`),r.push(...o))}),e.devices&&s.forEach(e.devices,e=>{const n=this.deviceManager.findDevice(e);null!=n?(t.debug(`Add device ${e})`),r.push(n)):t.information(`Device ${e} not found`)}),t.debug(`Expanded to ${r.length} devices`),r}applySettings(e){return n.__awaiter(this,void 0,void 0,function*(){const t=e.filter(e=>e.thermostatMode===o.NormalOperationMode.Automatic);this.logger.information(`Applying ${t.length} settings`,t.map(e=>({plans:e.conflictingPlans&&e.conflictingPlans.map(e=>`${e.name} (${e.id})`),device:e.device&&`${e.device.name} (${e.device.id})`,temperature:e.temperature,targetTemperature:e.targetTemperature}))),yield Promise.all(t.map(e=>n.__awaiter(this,void 0,void 0,function*(){return yield this.setTemperature(e.conflictingPlans.map(e=>e.name).join(", "),this.deviceManager.findDevice(e.device.id),e.targetTemperature)})))})}sendNotification(e,t){new i.Notification({excerpt:i.__(`Notification.${e}`,t)}).register()}};n.__decorate([f.trycatchlog(!0,o.NormalOperationMode.Automatic),n.__metadata("design:type",Number),n.__metadata("design:paramtypes",[Number])],v.prototype,"operationMode",null),v=n.__decorate([c.singleton(),n.__param(4,c.inject("FlowService")),n.__metadata("design:paramtypes",[h.HeatingPlanRepositoryService,u.HeatingPlanCalculator,p.DeviceManagerService,d.SettingsManagerService,l.FlowService,f.LoggerFactory])],v),t.HeatingManagerService=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(8),i=r(3),s=r(49),a=r(1),c=r(6),u=r(12);var p;!function(e){e[e.Changed=0]="Changed",e[e.Removed=1]="Removed"}(p=t.PlanChangeEventType||(t.PlanChangeEventType={}));let l=class{constructor(e,t){this.settings=e,this.planList=[],this.mutex=new o.Mutex,this.changed=!1,this.onChangedDispatcher=new s.EventDispatcher,this.logger=t.createLogger("Repository"),this.settings.onChanged.subscribe((e,t)=>{if(this.changed)this.changed=!1;else if(t.setting===u.Settings.Plans){this.logger.information("Reload due to settings change.");try{this.load(),this.onChangedDispatcher.dispatch(this,this.planList.map(e=>({plan:e,event:p.Changed})))}catch(t){this.logger.information("Reload of plans failed",t)}}})}replacePlans(e){this.planList=e||[],this.save()}load(){const e=this.settings.get(u.Settings.Plans);this.planList=null==e?[]:JSON.parse(e)}save(){this.changed=!0,this.settings.set(u.Settings.Plans,JSON.stringify(this.planList))}get plans(){return this.mutex.lock().then(e=>{const t=this.planList;return e(),t})}get activePlans(){return this.mutex.lock().then(e=>{const t=i.filter(this.planList,e=>e.enabled);return e(),t})}get onChanged(){return this.onChangedDispatcher.asEvent()}find(e){return n.__awaiter(this,void 0,void 0,function*(){return this.mutex.lock().then(t=>{const r=i.find(this.planList,t=>t.id===e);return t(),r})})}update(e,t=!0){return n.__awaiter(this,void 0,void 0,function*(){const r=Array.isArray(e)?e:[e],n=yield this.mutex.lock();r.forEach(e=>{this.logger.debug(`Updating plan ${e.id}`),i.remove(this.planList,t=>t.id===e.id),this.planList.push(e)}),this.save(),n(),t&&this.onChangedDispatcher.dispatch(this,r.map(e=>({plan:e,event:p.Changed})))})}add(e){return n.__awaiter(this,void 0,void 0,function*(){const t=yield this.mutex.lock();this.logger.debug(`Adding plan ${e.id}`),this.planList.push(e),this.save(),t(),this.onChangedDispatcher.dispatch(this,[{plan:e,event:p.Changed}])})}remove(e){return n.__awaiter(this,void 0,void 0,function*(){let t;const r=yield this.mutex.lock();this.logger.debug(`Removing plan ${e}`),t=i.find(this.planList,t=>t.id===e),i.remove(this.planList,t=>t.id===e),this.save(),r(),null!=t&&this.onChangedDispatcher.dispatch(this,[{plan:t,event:p.Removed}])})}};n.__decorate([c.trycatchlog(!0,[]),n.__metadata("design:type",Promise),n.__metadata("design:paramtypes",[])],l.prototype,"plans",null),n.__decorate([c.trycatchlog(!0,[]),n.__metadata("design:type",Promise),n.__metadata("design:paramtypes",[])],l.prototype,"activePlans",null),l=n.__decorate([a.singleton(),n.__metadata("design:paramtypes",[u.SettingsManagerService,c.LoggerFactory])],l),t.HeatingPlanRepositoryService=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);var o;const i=r(3),s=r(1);var a;!function(e){e.Min="use_min",e.Max="use_max"}(a=t.TemperatureConflictPolicy||(t.TemperatureConflictPolicy={}));let c=o=class{constructor(e){this.resolver=e}resolve(e){if(null!=e)return 1===e.length?e[0]:this.resolver(e,e=>e.targetTemperature)}};c=o=n.__decorate([s.registry([{token:a.Max,useFactory:e=>new o(i.maxBy)}]),s.registry([{token:a.Min,useFactory:e=>new o(i.minBy)}]),n.__metadata("design:paramtypes",[Function])],c),t.TemperatureConflictPolicyImplementation=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(14);t.ApplyAllAction=function({logger:e,manager:t}){return o.flowCardActionFactory("apply_all",e,(e,r)=>n.__awaiter(this,void 0,void 0,function*(){return yield t.applyPlans(),!0}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(14);t.ApplyPlanAction=function({logger:e,manager:t,repository:r}){return o.flowCardActionFactory("apply_plan",e,(e,o)=>n.__awaiter(this,void 0,void 0,function*(){const n=yield r.find(e.plan.id);return null==n?Promise.resolve(!1):(yield t.applyPlan(n),!0)})).getArgument("plan").registerAutocompleteListener((e,t)=>n.__awaiter(this,void 0,void 0,function*(){return(yield r.plans).map(e=>({id:e.id,name:e.name||e.id}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(14);t.ModeChangedTrigger=function({logger:e}){return n.flowCardTriggerFactory("mode_changed",e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(12),i=r(14);t.SetLogStateAction=function({logger:e,settings:t}){return i.flowCardActionFactory("set_log_state",e,(e,r)=>n.__awaiter(this,void 0,void 0,function*(){return t.set(o.Settings.ConsoleReLogEnabled,"true"===e.state),!0}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(14);t.SetModeAction=function({logger:e,manager:t}){return o.flowCardActionFactory("set_mode",e,(e,r)=>n.__awaiter(this,void 0,void 0,function*(){return t.operationMode=parseInt(e.state,10),!0}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(14);t.SetPlanStateAction=function({logger:e,repository:t}){return o.flowCardActionFactory("set_plan_state",e,(e,r)=>n.__awaiter(this,void 0,void 0,function*(){const r=yield t.find(e.plan.id);return null!=r&&(r.enabled="true"===e.state,yield t.update(r),!0)})).getArgument("plan").registerAutocompleteListener((e,r)=>n.__awaiter(this,void 0,void 0,function*(){return(yield t.plans).map(e=>({id:e.id,name:e.name||e.id}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(14);t.SetThermostatOverrideAction=function({logger:e}){return o.flowCardActionFactory("set_thermostat_override",e,(e,t)=>n.__awaiter(this,void 0,void 0,function*(){return yield e.my_device.changeThermostatMode(parseInt(e.mode,10)),!0}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(14);t.ThermostatModeChangedTrigger=function({logger:e}){return n.flowCardTriggerDeviceFactory("thermostat_override_changed",e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(8),i=r(1),s=r(24),a=r(26),c=new o.Mutex;let u=!1;t.BootStrapper=function(e=!1){return n.__awaiter(this,void 0,void 0,function*(){const t=yield c.lock();{if(u)return void t();e||console.info("********* APPLICATION STARTUP v1.2.1-alpha (222) *********");const r=i.container.resolve(s.DeviceManagerService),n=i.container.resolve(a.HeatingPlanRepositoryService);yield r.init(),n.load(),u=!0}t()})}}]);
//# sourceMappingURL=https://raw.githubusercontent.com/mskg/homey-heating/release/v1.2.1-alpha/node_modules/@app/services/index.js.map
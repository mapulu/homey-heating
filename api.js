module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=87)}({0:function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",function(){return i}),n.d(t,"__assign",function(){return o}),n.d(t,"__rest",function(){return a}),n.d(t,"__decorate",function(){return s}),n.d(t,"__param",function(){return c}),n.d(t,"__metadata",function(){return u}),n.d(t,"__awaiter",function(){return l}),n.d(t,"__generator",function(){return d}),n.d(t,"__exportStar",function(){return f}),n.d(t,"__values",function(){return p}),n.d(t,"__read",function(){return _}),n.d(t,"__spread",function(){return h}),n.d(t,"__await",function(){return g}),n.d(t,"__asyncGenerator",function(){return y}),n.d(t,"__asyncDelegator",function(){return v}),n.d(t,"__asyncValues",function(){return m}),n.d(t,"__makeTemplateObject",function(){return b}),n.d(t,"__importStar",function(){return S}),n.d(t,"__importDefault",function(){return x});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function c(e,t){return function(n,r){t(n,r,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})}function d(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function f(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function p(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function _(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_(arguments[t]));return e}function g(e){return this instanceof g?(this.v=e,this):new g(e)}function y(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{(n=i[e](t)).value instanceof g?Promise.resolve(n.value.v).then(c,u):l(o[0][2],n)}catch(e){l(o[0][3],e)}var n}function c(e){s("next",e)}function u(e){s("throw",e)}function l(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function v(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:g(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function m(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=p(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}}function b(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function x(e){return e&&e.__esModule?e:{default:e}}},1:function(e,t){e.exports=require("tsyringe")},15:function(e,t){e.exports=require("reflect-metadata")},18:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(4),o=n(1);t.SUCCESS="OK";class a{constructor(e,t){this.method=e,this.path=t,this.public=!1,a.initialize(),this.logger.information(`Bound endpoint ${e} ${t}`)}get logger(){return a.logger}static initialize(){if(a.initialized)return;const e=o.container.resolve(i.SettingsManagerService);e.onChanged.subscribe((e,t)=>{t.setting===i.InternalSettings.LogApi&&(a.logApi=t.value)}),a.logApi=!0===e.get(i.InternalSettings.LogApi,!1),a.logger=o.container.resolve(i.LoggerFactory).createLogger("Api"),a.initialized=!0}fn(e,t){return r.__awaiter(this,void 0,void 0,function*(){try{a.logApi?this.logger.debug(`${this.method} ${this.path} ${JSON.stringify(e)}`):this.logger.debug(`${this.method} ${this.path}`);const n=yield this.execute(e);a.logApi&&this.logger.debug(`${this.method} ${this.path}`,"Request:",JSON.stringify(e),"Response:",JSON.stringify(n)),t(null,n)}catch(n){this.logger.error(n,`${this.method} ${this.path} failed`,e),t(n,null)}})}}a.logApi=!1,a.initialized=!1,t.ApiBase=a},3:function(e,t){e.exports=require("lodash")},4:function(e,t){e.exports=require("@app/services")},48:function(e,t){e.exports=require("inspector")},8:function(e,t){e.exports=require("@app/helper")},87:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(15);const r=n(1),i=n(88),o=n(89),a=n(90),s=n(91),c=n(92),u=n(93);console.info("Bootstrapping API v1.2.1-alpha (222)"),e.exports=[...i.default,...c.default,...o.default,...a.default,...u.default,...s.default].map(e=>r.container.resolve(e))},88:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(1),o=n(18);let a=class extends o.ApiBase{constructor(){super("GET","/debugger/on"),this.public=!1}execute(e){return r.__awaiter(this,void 0,void 0,function*(){throw new Error("Access denied.")})}};a=r.__decorate([i.injectable(),r.__metadata("design:paramtypes",[])],a);t.default=[a,class extends o.ApiBase{constructor(){super("GET","/debugger/off"),this.public=!1}execute(e){return r.__awaiter(this,void 0,void 0,function*(){throw new Error("Access denied.")})}}]},89:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(4),o=n(1),a=n(18);let s=class extends a.ApiBase{constructor(e){super("PUT","/mode"),this.manager=e}execute(e){return r.__awaiter(this,void 0,void 0,function*(){const t=e.body.mode;return this.manager.operationMode=t,a.SUCCESS})}};s=r.__decorate([o.injectable(),r.__metadata("design:paramtypes",[i.HeatingManagerService])],s);let c=class extends a.ApiBase{constructor(e){super("GET","/mode"),this.manager=e}execute(){return r.__awaiter(this,void 0,void 0,function*(){return{mode:this.manager.operationMode}})}};c=r.__decorate([o.injectable(),r.__metadata("design:paramtypes",[i.HeatingManagerService])],c),t.default=[s,c]},90:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(8),o=n(4),a=n(3),s=n(1),c=n(18);let u=class extends c.ApiBase{constructor(e){super("GET","/resetplans"),this.manager=e}execute(){return r.__awaiter(this,void 0,void 0,function*(){return this.manager.replacePlans(i.DEFAULT_HEATING_PLAN),yield this.manager.plans})}};u=r.__decorate([s.injectable(),r.__metadata("design:paramtypes",[o.HeatingPlanRepositoryService])],u);let l=class extends c.ApiBase{constructor(e){super("GET","/plans"),this.manager=e}execute(){return r.__awaiter(this,void 0,void 0,function*(){return yield this.manager.plans})}};l=r.__decorate([s.injectable(),r.__metadata("design:paramtypes",[o.HeatingPlanRepositoryService])],l);let d=class extends c.ApiBase{constructor(e){super("GET","/plans/:id"),this.manager=e}execute(e){return r.__awaiter(this,void 0,void 0,function*(){return yield this.manager.find(e.params.id)})}};d=r.__decorate([s.injectable(),r.__metadata("design:paramtypes",[o.HeatingPlanRepositoryService])],d);let f=class extends c.ApiBase{constructor(e,t){super("PUT","/plans/:id"),this.manager=e,this.devices=t}execute(e){return r.__awaiter(this,void 0,void 0,function*(){const t=e.body;return t.id=e.params.id,t.devices&&a.remove(t.devices,e=>null==a.find(this.devices.devices,t=>t.id===e)),t.zones&&a.remove(t.zones,e=>null==a.find(this.devices.zones,t=>t.id===e)),t.enabled||delete t.thermostatMode,yield this.manager.update(t),t})}};f=r.__decorate([s.injectable(),r.__metadata("design:paramtypes",[o.HeatingPlanRepositoryService,o.DeviceManagerService])],f);let p=class extends c.ApiBase{constructor(e){super("DELETE","/plans/:id"),this.manager=e}execute(e){return r.__awaiter(this,void 0,void 0,function*(){return yield this.manager.remove(e.params.id),c.SUCCESS})}};p=r.__decorate([s.injectable(),r.__metadata("design:paramtypes",[o.HeatingPlanRepositoryService])],p),t.default=[p,d,f,l,u]},91:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(4),o=n(1),a=n(18);let s=class extends a.ApiBase{constructor(e,t){super("GET","/schedule"),this.manager=e,this.scheduler=t}execute(){return r.__awaiter(this,void 0,void 0,function*(){return{mode:this.manager.operationMode,nextDate:this.scheduler.nextSchedule,temperatures:yield this.manager.evaluateActivePlans()}})}};s=r.__decorate([o.injectable(),r.__metadata("design:paramtypes",[i.HeatingManagerService,i.HeatingSchedulerService])],s),t.default=[s]},92:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(4),o=n(3),a=n(1),s=n(18);let c=class extends s.ApiBase{constructor(e){super("GET","/settings"),this.manager=e}execute(){return r.__awaiter(this,void 0,void 0,function*(){const e={};return o.forEach(Object.keys(i.Settings),t=>{e[t]=this.manager.get(i.Settings[t])}),e})}};c=r.__decorate([a.injectable(),r.__metadata("design:paramtypes",[i.SettingsManagerService])],c);let u=class extends s.ApiBase{constructor(e){super("PUT","/settings"),this.manager=e}execute(e){return r.__awaiter(this,void 0,void 0,function*(){const t=e.body;return o.forEach([...Object.keys(i.Settings),...Object.keys(i.InternalSettings)],e=>{const n=i.Settings[e];t.hasOwnProperty(e)&&(this.manager.get(n)!==t[e]?this.manager.set(n,t[e]):this.logger.debug(`Setting ${n} did not change.`))}),s.SUCCESS})}};u=r.__decorate([a.injectable(),r.__metadata("design:paramtypes",[i.SettingsManagerService])],u),t.default=[c,u]},93:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(4),o=n(3),a=n(1),s=n(18);let c=class extends s.ApiBase{constructor(e){super("GET","/zones"),this.manager=e}execute(){return r.__awaiter(this,void 0,void 0,function*(){return o.map(this.manager.zones,e=>({id:e.id,name:e.name,icon:e.icon}))})}};c=r.__decorate([a.injectable(),r.__metadata("design:paramtypes",[i.DeviceManagerService])],c);let u=class extends s.ApiBase{constructor(e){super("GET","/devices"),this.manager=e}execute(){return r.__awaiter(this,void 0,void 0,function*(){return o.map(this.manager.devices,e=>({id:e.id,name:e.name,icon:e.iconObj&&e.iconObj.url}))})}};u=r.__decorate([a.injectable(),r.__metadata("design:paramtypes",[i.DeviceManagerService])],u),t.default=[u,c]}});
//# sourceMappingURL=https://raw.githubusercontent.com/mskg/homey-heating/release/v1.2.1-alpha/api.js.map